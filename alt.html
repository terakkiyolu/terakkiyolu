<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>THE LENG - Yönetici Paneli</title>
  
   PWA Meta Tags 
  <meta name="theme-color" content="#0f172a">
  <meta name="description" content="THE LENG Yönetici Paneli - Satış, Gider ve Müşteri Yönetimi">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="THE LENG">
  
   PWA Icons 
  <link rel="icon" type="image/png" sizes="192x192" href="the1.png">
  <link rel="apple-touch-icon" href="the1.png">
  <link rel="apple-touch-icon" sizes="152x152" href="the1.png">
  <link rel="apple-touch-icon" sizes="180x180" href="the1.png">
  <link rel="apple-touch-icon" sizes="167x167" href="the1.png">
  
   Manifest 
  <link rel="manifest" href="manifest.json">
  
   Font Awesome 
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  
  <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          outline: none;
          -webkit-tap-highlight-color: transparent;
          -webkit-touch-callout: none;
          -webkit-user-select: none;
          -khtml-user-select: none;
          -moz-user-select: none;
          -ms-user-select: none;
          user-select: none;
      }

      input, textarea, select {
          -webkit-user-select: text;
          -moz-user-select: text;
          -ms-user-select: text;
          user-select: text;
      }

      *:focus {
          outline: none !important;
          box-shadow: none !important;
      }

      /* Ripple Effect Styles */
      .ripple {
          position: relative;
          overflow: hidden;
      }

      .ripple::before {
          content: '';
          position: absolute;
          top: 50%;
          left: 50%;
          width: 0;
          height: 0;
          border-radius: 50%;
          background: rgba(255, 255, 255, 0.3);
          transform: translate(-50%, -50%);
          transition: width 0.6s, height 0.6s;
          pointer-events: none;
          z-index: 1;
      }

      .ripple:active::before {
          width: 300px;
          height: 300px;
      }

      .ripple-dark::before {
          background: rgba(0, 0, 0, 0.2);
      }

      .ripple-primary::before {
          background: rgba(15, 23, 42, 0.3);
      }

      .ripple-success::before {
          background: rgba(5, 150, 105, 0.3);
      }

      .ripple-danger::before {
          background: rgba(220, 38, 38, 0.3);
      }

      .ripple-warning::before {
          background: rgba(245, 158, 11, 0.3);
      }

      /* Default Theme (Light) */
      :root, [data-theme="default-light"] {
          --bg-primary: #ffffff;
          --bg-secondary: #f8fafc;
          --bg-tertiary: #f1f5f9;
          --text-primary: #0f172a;
          --text-secondary: #64748b;
          --border-color: #e2e8f0;
          --shadow: rgba(0, 0, 0, 0.08);
          --shadow-dark: rgba(0, 0, 0, 0.15);
          --danger-color: #dc2626;
          --warning-color: #f59e0b;
          --success-color: #059669;
          --info-color: #0ea5e9;
          --primary-color: #0f172a;
          --sidebar-width: 288px;
          --header-height: 56px;
          --border-radius-base: 6px;
          --font-family-base: 'Inter', -apple-system, BlinkMacMacFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      }

      /* Default Theme (Dark) */
      [data-theme="default-dark"] {
          --bg-primary: #0f172a;
          --bg-secondary: #1e293b;
          --bg-tertiary: #334155;
          --text-primary: #ffffff;
          --text-secondary: #94a3b8;
          --border-color: #334155;
          --shadow: rgba(255, 255, 255, 0.08);
          --shadow-dark: rgba(255, 255, 255, 0.15);
          --primary-color: #60a5fa; /* Lighter primary for dark mode */
      }

      /* Modern Theme (Light) */
      [data-theme="modern-light"] {
          --bg-primary: #f0f4f8;
          --bg-secondary: #e2e8f0;
          --bg-tertiary: #d1d9e0;
          --text-primary: #2d3748;
          --text-secondary: #718096;
          --border-color: #cbd5e0;
          --shadow: rgba(45, 55, 72, 0.1);
          --shadow-dark: rgba(45, 55, 72, 0.2);
          --primary-color: #4299e1;
          --border-radius-base: 12px;
          --font-family-base: 'Roboto', sans-serif;
      }

      /* Modern Theme (Dark) */
      [data-theme="modern-dark"] {
          --bg-primary: #1a202c;
          --bg-secondary: #2d3748;
          --bg-tertiary: #4a5568;
          --text-primary: #e2e8f0;
          --text-secondary: #a0aec0;
          --border-color: #4a5568;
          --shadow: rgba(255, 255, 255, 0.05);
          --shadow-dark: rgba(255, 255, 255, 0.1);
          --primary-color: #63b3ed;
          --border-radius-base: 12px;
          --font-family-base: 'Roboto', sans-serif;
      }

      /* Minimal Theme (Light) */
      [data-theme="minimal-light"] {
          --bg-primary: #ffffff;
          --bg-secondary: #f7f7f7;
          --bg-tertiary: #eeeeee;
          --text-primary: #333333;
          --text-secondary: #666666;
          --border-color: #dddddd;
          --shadow: rgba(0, 0, 0, 0.05);
          --shadow-dark: rgba(0, 0, 0, 0.1);
          --primary-color: #007bff;
          --border-radius-base: 4px;
          --font-family-base: 'Open Sans', sans-serif;
      }

      /* Minimal Theme (Dark) */
      [data-theme="minimal-dark"] {
          --bg-primary: #222222;
          --bg-secondary: #333333;
          --bg-tertiary: #444444;
          --text-primary: #ffffff;
          --text-secondary: #cccccc;
          --border-color: #555555;
          --shadow: rgba(255, 255, 255, 0.03);
          --shadow-dark: rgba(255, 255, 255, 0.07);
          --primary-color: #66b3ff;
          --border-radius-base: 4px;
          --font-family-base: 'Open Sans', sans-serif;
      }

      body {
          font-family: var(--font-family-base);
          background-color: var(--bg-primary);
          color: var(--text-primary);
          transition: all 0.3s ease;
          line-height: 1.5;
      }

      /* Apply theme-specific styles */
      .card, .stat-card, .tab-list, .tab-trigger, .btn, input, select, textarea, .customer-suggestion, .table-container, .employee-card, .admin-nav-btn, .payment-option {
          border-radius: var(--border-radius-base);
      }

      .card, .stat-card, .table-container, .employee-card, .modal-content {
          border: 1px solid var(--border-color);
      }

      .card-header, .sidebar-header {
          border-bottom: 1px solid var(--border-color);
      }

      .tab-trigger.active {
          box-shadow: 0 1px 3px var(--shadow);
      }

      .stat-card:hover {
          box-shadow: 0 4px 12px var(--shadow-dark);
      }

      .search-input:focus, input:focus, select:focus, textarea:focus {
          border-color: var(--primary-color);
          box-shadow: 0 0 0 3px var(--shadow);
      }

      .btn-primary {
          background-color: var(--primary-color);
      }

      .btn-primary:hover {
          background-color: color-mix(in srgb, var(--primary-color) 80%, black);
      }

      .payment-option.selected {
          border-color: var(--primary-color);
          background-color: var(--primary-color);
          color: white;
      }

      /* Overlay */
      .overlay {
          position: fixed;
          inset: 0;
          background-color: rgba(0, 0, 0, 0.5);
          z-index: 40;
          display: none;
      }

      .overlay.show {
          display: block;
      }

      @media (min-width: 1024px) {
          .overlay {
              display: none !important;
          }
      }

      /* Sidebar Styles */
      .sidebar {
          position: fixed;
          left: 0;
          top: 0;
          width: var(--sidebar-width);
          height: 100vh;
          background-color: var(--bg-primary);
          border-right: 1px solid var(--border-color);
          z-index: 50;
          transform: translateX(-100%);
          transition: transform 0.3s ease;
      }

      .sidebar.open {
          transform: translateX(0);
      }

      @media (min-width: 1024px) {
          .sidebar {
              transform: translateX(0);
          }
      }

      .sidebar-header {
          height: var(--header-height);
          display: flex;
          align-items: center;
          padding: 0 16px;
          border-bottom: 1px solid var(--border-color);
          gap: 12px;
      }

      .sidebar-logo {
          width: 32px;
          height: 32px;
          border-radius: 6px;
          object-fit: cover;
      }

      .sidebar-title {
          font-size: 18px;
          font-weight: 600;
          color: var(--text-primary);
      }

      .sidebar-nav {
          padding: 8px;
          height: calc(100vh - var(--header-height));
          overflow-y: auto;
          display: flex;
          flex-direction: column;
      }

      .nav-section {
          flex: 1;
      }

      .nav-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 8px 12px;
          margin: 2px 0;
          border-radius: var(--border-radius-base);
          text-decoration: none;
          color: var(--text-secondary);
          font-size: 14px;
          font-weight: 500;
          transition: all 0.2s;
          cursor: pointer;
      }

      .nav-item:hover {
          background-color: var(--bg-tertiary);
          color: var(--text-primary);
      }

      .nav-item.active {
          background-color: var(--bg-tertiary);
          color: var(--text-primary);
      }

      .nav-item i {
          width: 20px;
          height: 20px;
          display: flex;
          align-items: center;
          justify-content: center;
      }

      .nav-badge {
          margin-left: auto;
          background-color: var(--danger-color);
          color: white;
          font-size: 10px;
          padding: 2px 6px;
          border-radius: 50%;
          min-width: 20px;
          height: 20px;
          display: flex;
          align-items: center;
          justify-content: center;
      }

      .nav-footer {
          border-top: 1px solid var(--border-color);
          padding-top: 8px;
      }

      /* Main Content */
      .main-content {
          margin-left: 0;
          min-height: 100vh;
          transition: margin-left 0.3s ease;
      }

      @media (min-width: 1024px) {
          .main-content {
              margin-left: var(--sidebar-width);
          }
      }

      /* Header */
      .header {
          height: var(--header-height);
          background-color: var(--bg-primary);
          border-bottom: 1px solid var(--border-color);
          display: flex;
          align-items: center;
          padding: 0 16px;
          gap: 16px;
          position: sticky;
          top: 0;
          z-index: 40;
      }

      .menu-toggle {
          display: block;
          background: none;
          border: none;
          padding: 8px;
          border-radius: var(--border-radius-base);
          cursor: pointer;
          color: var(--text-secondary);
      }

      @media (min-width: 1024px) {
          .menu-toggle {
              display: none;
          }
      }

      .search-container {
          flex: 1;
          max-width: 300px;
          position: relative;
      }

      .search-input {
          width: 100%;
          padding: 8px 12px 8px 36px;
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius-base);
          font-size: 14px;
          outline: none;
          background-color: var(--bg-primary);
          color: var(--text-primary);
      }

      .search-input:focus {
          border-color: var(--primary-color);
          box-shadow: 0 0 0 3px var(--shadow);
      }

      .search-icon {
          position: absolute;
          left: 10px;
          top: 50%;
          transform: translateY(-50%);
          color: var(--text-secondary);
      }

      .header-actions {
          display: flex;
          align-items: center;
          gap: 8px;
      }

      .header-btn {
          background: none;
          border: none;
          padding: 8px;
          border-radius: var(--border-radius-base);
          cursor: pointer;
          color: var(--text-secondary);
          transition: background-color 0.2s;
      }

      .header-btn:hover {
          background-color: var(--bg-tertiary);
      }

      /* File System Status */
      .file-status {
          position: fixed;
          top: 70px;
          right: 20px;
          background: var(--success-color);
          color: white;
          padding: 8px 16px;
          border-radius: 20px;
          font-size: 0.75rem;
          font-weight: 600;
          z-index: 999;
          display: none;
          box-shadow: 0 4px 12px var(--shadow-dark);
      }

      .file-status.error {
          background: var(--danger-color);
      }

      .file-status.warning {
          background: var(--warning-color);
          color: var(--text-primary);
      }

      /* Page Content */
      .page-content {
          padding: 16px;
      }

      @media (min-width: 768px) {
          .page-content {
              padding: 24px;
          }
      }

      @media (min-width: 1024px) {
          .page-content {
              padding: 32px;
          }
      }

      .page-header {
          margin-bottom: 24px;
      }

      .page-title {
          font-size: 24px;
          font-weight: 700;
          margin-bottom: 4px;
          color: var(--text-primary);
      }

      @media (min-width: 768px) {
          .page-title {
              font-size: 30px;
          }
      }

      .page-description {
          color: var(--text-secondary);
          font-size: 14px;
      }

      /* Tabs */
      .tabs {
          margin-bottom: 24px;
      }

      .tab-list {
          display: flex;
          background-color: var(--bg-tertiary);
          border-radius: var(--border-radius-base);
          padding: 4px;
          width: fit-content;
      }

      .tab-trigger {
          background: none;
          border: none;
          padding: 8px 16px;
          border-radius: calc(var(--border-radius-base) - 2px);
          cursor: pointer;
          font-size: 14px;
          font-weight: 500;
          color: var(--text-secondary);
          transition: all 0.2s;
      }

      .tab-trigger.active {
          background-color: var(--bg-primary);
          color: var(--text-primary);
          box-shadow: 0 1px 3px var(--shadow);
      }

      .tab-content {
          display: none;
      }

      .tab-content.active {
          display: block;
      }

      /* Cards */
      .card {
          background-color: var(--bg-primary);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius-base);
          overflow: hidden;
          margin-bottom: 16px;
      }

      .card-header {
          padding: 16px;
          border-bottom: 1px solid var(--border-color);
      }

      .card-title {
          font-size: 18px;
          font-weight: 600;
          margin-bottom: 4px;
          color: var(--text-primary);
      }

      .card-description {
          color: var(--text-secondary);
          font-size: 14px;
      }

      .card-content {
          padding: 16px;
      }

      /* Stats Grid */
      .stats-grid {
          display: grid;
          gap: 16px;
          grid-template-columns: 1fr;
          margin-bottom: 24px;
      }

      @media (min-width: 640px) {
          .stats-grid {
              grid-template-columns: repeat(2, 1fr);
          }
      }

      @media (min-width: 1024px) {
          .stats-grid {
              grid-template-columns: repeat(4, 1fr);
          }
      }

      .stat-card {
          background-color: var(--bg-primary);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius-base);
          padding: 16px;
          transition: all 0.3s ease;
          cursor: pointer;
      }

      .stat-card:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 12px var(--shadow-dark);
      }

      .stat-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 8px;
      }

      .stat-title {
          font-size: 14px;
          font-weight: 500;
          color: var(--text-secondary);
      }

      .stat-icon {
          color: var(--text-secondary);
          font-size: 20px;
      }

      .stat-value {
          font-size: 24px;
          font-weight: 700;
          margin-bottom: 4px;
          color: var(--text-primary);
      }

      .stat-change {
          font-size: 12px;
          color: var(--text-secondary);
      }

      .stat-change.positive {
          color: var(--success-color);
      }

      .stat-change.negative {
          color: var(--danger-color);
      }

      /* Forms */
      .form-group {
          margin-bottom: 16px;
      }

      .form-row {
          display: grid;
          gap: 16px;
          grid-template-columns: 1fr;
      }

      @media (min-width: 768px) {
          .form-row {
              grid-template-columns: repeat(2, 1fr);
          }
      }

      label {
          display: block;
          margin-bottom: 8px;
          font-weight: 500;
          color: var(--text-primary);
          font-size: 14px;
      }

      input, select, textarea {
          width: 100%;
          padding: 8px 12px;
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius-base);
          background-color: var(--bg-primary);
          color: var(--text-primary);
          font-size: 14px;
          transition: all 0.2s ease;
      }

      input:focus, select:focus, textarea:focus {
          border-color: var(--primary-color);
          box-shadow: 0 0 0 3px var(--shadow);
      }

      /* Buttons */
      .btn {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          padding: 8px 16px;
          border-radius: var(--border-radius-base);
          font-size: 14px;
          font-weight: 500;
          text-decoration: none;
          cursor: pointer;
          transition: all 0.2s;
          border: none;
          justify-content: center;
      }

      .btn-secondary {
          background-color: transparent;
          color: var(--text-primary);
          border: 1px solid var(--border-color);
      }

      .btn-secondary:hover {
          background-color: var(--bg-tertiary);
      }

      .btn-danger {
          background-color: var(--danger-color);
          color: white;
      }

      .btn-danger:hover {
          background-color: color-mix(in srgb, var(--danger-color) 80%, black);
      }

      .btn-warning {
          background-color: var(--warning-color);
          color: white;
      }

      .btn-warning:hover {
          background-color: color-mix(in srgb, var(--warning-color) 80%, black);
      }

      .btn-success {
          background-color: var(--success-color);
          color: white;
      }

      .btn-success:hover {
          background-color: color-mix(in srgb, var(--success-color) 80%, black);
      }

      .btn-small {
          padding: 4px 8px;
          font-size: 12px;
      }

      .btn-ghost {
          background-color: transparent;
          color: var(--text-secondary);
          border: none;
      }

      .btn-ghost:hover {
          background-color: var(--bg-tertiary);
          color: var(--text-primary);
      }

      /* Customer Autocomplete */
      .customer-autocomplete {
          position: relative;
      }

      .customer-suggestions {
          position: absolute;
          top: 100%;
          left: 0;
          right: 0;
          background: var(--bg-primary);
          border: 1px solid var(--border-color);
          border-top: none;
          border-radius: 0 0 var(--border-radius-base) var(--border-radius-base);
          max-height: 200px;
          overflow-y: auto;
          z-index: 100;
          display: none;
      }

      .customer-suggestion {
          padding: 12px;
          cursor: pointer;
          border-bottom: 1px solid var(--border-color);
          transition: background-color 0.2s ease;
      }

      .customer-suggestion:hover,
      .customer-suggestion.selected {
          background-color: var(--bg-secondary);
      }

      .customer-suggestion:last-child {
          border-bottom: none;
      }

      /* Tables */
      .table-container {
          overflow-x: auto;
          border-radius: var(--border-radius-base);
          border: 1px solid var(--border-color);
      }

      .table {
          width: 100%;
          border-collapse: collapse;
      }

      .table th,
      .table td {
          padding: 12px;
          text-align: left;
          border-bottom: 1px solid var(--border-color);
          font-size: 14px;
      }

      .table th {
          font-weight: 600;
          color: var(--text-secondary);
          background-color: var(--bg-secondary);
      }

      .table td {
          color: var(--text-primary);
      }

      .table tr:hover {
          background-color: var(--bg-secondary);
      }

      /* Payment Options */
      .payment-options {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 8px;
          margin-bottom: 16px;
      }

      .payment-option {
          padding: 12px;
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius-base);
          text-align: center;
          cursor: pointer;
          transition: all 0.2s ease;
          font-size: 14px;
          font-weight: 500;
          background: var(--bg-primary);
          color: var(--text-primary);
      }

      /* Modals */
      .modal {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0,0,0,0.6);
          z-index: 2000;
          padding: 16px;
      }

      .modal-content {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: var(--bg-primary);
          padding: 24px;
          border-radius: var(--border-radius-base);
          border: 1px solid var(--border-color);
          width: 100%;
          max-width: 600px;
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      }

      .close {
          position: absolute;
          top: 16px;
          right: 16px;
          font-size: 20px;
          cursor: pointer;
          color: var(--text-secondary);
          width: 32px;
          height: 32px;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 50%;
          transition: all 0.2s ease;
      }

      .close:hover {
          background: var(--bg-secondary);
          color: var(--text-primary);
      }

      /* Status Badge */
      .status-badge {
          display: inline-flex;
          align-items: center;
          padding: 4px 8px;
          border-radius: 12px;
          font-size: 12px;
          font-weight: 600;
      }

      .status-active {
          background-color: #dcfce7;
          color: #166534;
      }

      .status-pending {
          background-color: #fef3c7;
          color: #92400e;
      }

      /* Admin Panel Styles */
      .admin-page {
          display: none;
      }

      .admin-page.active {
          display: block;
      }

      .admin-nav {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 16px;
          margin-bottom: 24px;
      }

      .admin-nav-btn {
          padding: 12px 16px;
          background: var(--bg-primary);
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius-base);
          cursor: pointer;
          transition: all 0.2s ease;
          text-align: center;
          font-weight: 500;
          color: var(--text-primary);
          font-size: 14px;
      }

      .admin-nav-btn.active {
          border-color: var(--primary-color);
          background: var(--primary-color);
          color: white;
      }

      .admin-content {
          display: none;
      }

      .admin-content.active {
          display: block;
      }

      /* Employee Management */
      .employee-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 16px;
          margin-bottom: 24px;
      }

      .employee-card {
          background: var(--bg-secondary);
          padding: 16px;
          border-radius: var(--border-radius-base);
          border: 1px solid var(--border-color);
          text-align: center;
          transition: all 0.2s ease;
      }

      .employee-card:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 12px var(--shadow-dark);
      }

      .employee-name {
          font-size: 16px;
          font-weight: 600;
          margin-bottom: 8px;
          color: var(--text-primary);
      }

      .employee-code {
          background: var(--primary-color);
          color: white;
          padding: 4px 8px;
          border-radius: 12px;
          font-size: 12px;
          font-weight: 600;
      }

      /* Customer Items */
      .customer-item {
          padding: 16px;
          border: 1px solid var(--border-color);
          border-radius: var(--border-radius-base);
          margin-bottom: 8px;
          transition: all 0.2s ease;
      }

      .customer-item:hover {
          background-color: var(--bg-secondary);
          transform: translateY(-1px);
          box-shadow: 0 2px 8px var(--shadow);
      }

      .customer-name {
          font-size: 16px;
          font-weight: 600;
          margin-bottom: 4px;
          color: var(--text-primary);
      }

      .customer-info {
          font-size: 14px;
          color: var(--text-secondary);
          display: flex;
          align-items: center;
          gap: 8px;
          flex-wrap: wrap;
      }

      /* Alerts */
      .alert {
          padding: 12px 16px;
          border-radius: var(--border-radius-base);
          margin-bottom: 16px;
          font-weight: 500;
          border: 1px solid var(--border-color);
          display: flex;
          align-items: center;
          gap: 8px;
      }

      .alert-success {
          background-color: rgba(5, 150, 105, 0.1);
          color: var(--success-color);
          border-color: var(--success-color);
      }

      .alert-error {
          background-color: rgba(220, 38, 38, 0.1);
          color: var(--danger-color);
          border-color: var(--danger-color);
      }

      /* Responsive Design */
      @media (max-width: 768px) {
          .payment-options {
              grid-template-columns: 1fr;
          }

          .stats-grid {
              grid-template-columns: 1fr;
          }

          .form-row {
              grid-template-columns: 1fr;
          }
      }

      /* Utility Classes */
      .hidden-mobile {
          display: none;
      }

      @media (min-width: 768px) {
          .hidden-mobile {
              display: block;
          }
      }

      .text-center { text-align: center; }
      .text-right { text-align: right; }
      .mb-1 { margin-bottom: 8px; }
      .mb-2 { margin-bottom: 16px; }
      .mb-3 { margin-bottom: 24px; }
      .mt-1 { margin-top: 8px; }
      .mt-2 { margin-top: 16px; }
      .mt-3 { margin-top: 24px; }
      .d-flex { display: flex; }
      .align-center { align-items: center; }
      .justify-between { justify-content: space-between; }
      .gap-1 { gap: 8px; }
      .gap-2 { gap: 16px; }
      .w-full { width: 100%; }
      .h-full { height: 100%; }
  </style>
</head>
<body>
   File System Status 
  <div id="fileStatus" class="file-status">Dosya Sistemi Hazır</div>

   Overlay 
  <div class="overlay" id="overlay"></div>

   Sidebar 
  <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
          <img src="the1.png" alt="THE LENG Logo" class="sidebar-logo">
          <div class="sidebar-title">THE LENG</div>
          <button class="header-btn menu-toggle ripple" id="sidebarClose" style="margin-left: auto;">
              <i class="fas fa-times"></i>
          </button>
      </div>
      <nav class="sidebar-nav">
          <div class="nav-section">
              <div class="nav-item ripple active" data-page="dashboard">
                  <i class="fas fa-th-large"></i>
                  <span>Panel</span>
              </div>
              <div class="nav-item ripple" data-page="sales">
                  <i class="fas fa-shopping-cart"></i>
                  <span>Satış</span>
              </div>
              <div class="nav-item ripple" data-page="expenses">
                  <i class="fas fa-receipt"></i>
                  <span>Gider</span>
              </div>
              <div class="nav-item ripple" data-page="customers">
                  <i class="fas fa-users"></i>
                  <span>Müşteri</span>
              </div>
              <div class="nav-item ripple" data-page="reports">
                  <i class="fas fa-chart-bar"></i>
                  <span>Rapor</span>
              </div>
              <div class="nav-item ripple" data-page="data">
                  <i class="fas fa-database"></i>
                  <span>Veri</span>
              </div>
          </div>
          <div class="nav-footer">
              <div class="nav-item ripple" onclick="showAdminLogin()">
                  <i class="fas fa-user-shield"></i>
                  <span>Yönetici</span>
              </div>
              <div class="nav-item ripple" data-page="settings">
                  <i class="fas fa-cog"></i>
                  <span>Ayarlar</span>
              </div>
          </div>
      </nav>
  </div>

   Main Content 
  <div class="main-content">
       Header 
      <header class="header">
          <button class="menu-toggle ripple" id="menuToggle">
              <i class="fas fa-bars"></i>
          </button>
          
          <div class="search-container">
              <i class="fas fa-search search-icon"></i>
              <input type="search" class="search-input" placeholder="Ara...">
          </div>

          <div class="header-actions">
              <button class="header-btn ripple" onclick="showPendingPayments()">
                  <i class="fas fa-bell"></i>
                  <span class="nav-badge" id="debtBadge" style="display: none;">0</span>
              </button>
              <button class="header-btn ripple" onclick="cycleTheme()">
                  <i class="fas fa-palette" id="themeToggleIcon"></i>
              </button>
          </div>
      </header>

       Main App 
      <div id="mainApp" class="main-app">
          <main class="page-content">
               Dashboard Page 
              <div id="dashboard-page" class="page">
                  <div class="page-header">
                      <h1 class="page-title">Genel Durum</h1>
                      <p class="page-description">İşletmenizin genel performansı ve istatistikleri</p>
                  </div>

                   Tabs 
                  <div class="tabs">
                      <div class="tab-list">
                          <button class="tab-trigger ripple active" data-tab="today">Bugün</button>
                          <button class="tab-trigger ripple" data-tab="week">Bu Hafta</button>
                          <button class="tab-trigger ripple" data-tab="month">Bu Ay</button>
                      </div>

                       Today Tab 
                      <div class="tab-content active" id="today-tab">
                          <div class="stats-grid">
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">Bugünkü Gelir</span>
                                      <i class="fas fa-lira-sign stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="totalSales">0</div>
                                  <div class="stat-change positive" id="salesChange">+0%</div>
                              </div>
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">Bugünkü Gider</span>
                                      <i class="fas fa-receipt stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="totalExpenses">0</div>
                                  <div class="stat-change negative" id="expensesChange">+0%</div>
                              </div>
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">Net Kar</span>
                                      <i class="fas fa-chart-line stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="netProfit">0</div>
                                  <div class="stat-change" id="profitChange">0%</div>
                              </div>
                              <div class="stat-card ripple" onclick="showPendingPayments()">
                                  <div class="stat-header">
                                      <span class="stat-title">Toplam Borç</span>
                                      <i class="fas fa-exclamation-triangle stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="totalDebt">0</div>
                                  <div class="stat-change">Tüm Zamanlar</div>
                              </div>
                          </div>
                      </div>
                  </div>

                   Recent Transactions 
                  <div class="card">
                      <div class="card-header">
                          <h3 class="card-title">Son İşlemler</h3>
                          <p class="card-description">En son gerçekleştirilen işlemler</p>
                      </div>
                      <div class="card-content" style="padding: 0;">
                          <div class="table-container">
                              <table class="table">
                                  <thead>
                                      <tr>
                                          <th>Tarih</th>
                                          <th>Tür</th>
                                          <th>Açıklama</th>
                                          <th>Tutar</th>
                                          <th>Ödeme</th>
                                          <th>Çalışan</th>
                                      </tr>
                                  </thead>
                                  <tbody id="recentTransactions">
                                  </tbody>
                              </table>
                          </div>
                      </div>
                  </div>
              </div>

               Sales Page 
              <div id="sales-page" class="page" style="display: none;">
                  <div class="page-header">
                      <h1 class="page-title">Satış Girişi</h1>
                      <p class="page-description">Yeni satış işlemi kaydedin</p>
                  </div>

                  <div class="card">
                      <div class="card-content">
                          <form id="salesForm">
                              <div class="form-row">
                                  <div class="form-group customer-autocomplete">
                                      <label for="customerName">Müşteri Adı <small>(F1 ile seç)</small></label>
                                      <input type="text" id="customerName" required>
                                      <div class="customer-suggestions" id="customerSuggestions"></div>
                                  </div>
                                  <div class="form-group">
                                      <label for="customerSurname">Müşteri Soyadı</label>
                                      <input type="text" id="customerSurname" required>
                                  </div>
                              </div>
                              <div class="form-row">
                                  <div class="form-group">
                                      <label for="customerPhone">Telefon Numarası</label>
                                      <input type="tel" id="customerPhone" required>
                                  </div>
                                  <div class="form-group">
                                      <label for="carpetArea">Halı m²</label>
                                      <input type="number" id="carpetArea" step="0.01" required>
                                  </div>
                              </div>
                              <div class="form-row">
                                  <div class="form-group">
                                      <label for="salePrice">Satış Fiyatı (<span id="currencySymbol1">₺</span>)</label>
                                      <input type="number" id="salePrice" step="0.01" required>
                                  </div>
                                  <div class="form-group">
                                      <label for="employeeCode">Çalışan Kodu</label>
                                      <input type="password" id="employeeCode" maxlength="3" required>
                                  </div>
                              </div>
                              
                              <div class="form-group">
                                  <label>Ödeme Türü</label>
                                  <div class="payment-options">
                                      <div class="payment-option ripple selected" onclick="selectPaymentType('cash')">
                                          <i class="fas fa-money-bill-wave"></i>
                                          <div>Nakit</div>
                                      </div>
                                      <div class="payment-option ripple" onclick="selectPaymentType('card')">
                                          <i class="fas fa-credit-card"></i>
                                          <div>Kart</div>
                                      </div>
                                      <div class="payment-option ripple" onclick="selectPaymentType('debt')">
                                          <i class="fas fa-file-invoice"></i>
                                          <div>Borç</div>
                                      </div>
                                  </div>
                              </div>

                              <div id="debtOptions" style="display: none;">
                                  <div class="form-group">
                                      <label for="paidAmount">Ödenen Tutar (<span id="currencySymbol2">₺</span>)</label>
                                      <input type="number" id="paidAmount" step="0.01" value="0">
                                  </div>
                                  <div class="form-group" id="paidPaymentTypeGroup">
                                      <label>Ödenen Kısmın Türü</label>
                                      <div class="payment-options">
                                          <div class="payment-option ripple selected" onclick="selectPaidPaymentType('cash')">
                                              <i class="fas fa-money-bill-wave"></i>
                                              <div>Nakit</div>
                                          </div>
                                          <div class="payment-option ripple" onclick="selectPaidPaymentType('card')">
                                              <i class="fas fa-credit-card"></i>
                                              <div>Kart</div>
                                          </div>
                                      </div>
                                  </div>
                              </div>

                              <button type="submit" class="btn btn-primary ripple-primary w-full">
                                  <i class="fas fa-check"></i>
                                  Satış Kaydet
                              </button>
                          </form>
                      </div>
                  </div>
              </div>

               Expenses Page 
              <div id="expenses-page" class="page" style="display: none;">
                  <div class="page-header">
                      <h1 class="page-title">Gider Girişi</h1>
                      <p class="page-description">Yeni gider kaydı oluşturun</p>
                  </div>

                  <div class="card">
                      <div class="card-content">
                          <form id="expensesForm">
                              <div class="form-row">
                                  <div class="form-group">
                                      <label for="expenseDescription">Gider Açıklaması</label>
                                      <input type="text" id="expenseDescription" required>
                                  </div>
                                  <div class="form-group">
                                      <label for="expenseAmount">Gider Tutarı (<span id="currencySymbol3">₺</span>)</label>
                                      <input type="number" id="expenseAmount" step="0.01" required>
                                  </div>
                              </div>
                              <div class="form-row">
                                  <div class="form-group">
                                      <label for="expenseCategory">Kategori</label>
                                      <select id="expenseCategory" required>
                                          <option value="">Kategori Seçin</option>
                                          <option value="kira">Kira</option>
                                          <option value="elektrik">Elektrik</option>
                                          <option value="su">Su</option>
                                          <option value="telefon">Telefon</option>
                                          <option value="malzeme">Malzeme</option>
                                          <option value="personel">Personel</option>
                                          <option value="diger">Diğer</option>
                                      </select>
                                  </div>
                                  <div class="form-group">
                                      <label for="expenseEmployeeCode">Çalışan Kodu</label>
                                      <input type="password" id="expenseEmployeeCode" maxlength="3" required>
                                  </div>
                              </div>
                              <button type="submit" class="btn btn-primary ripple-primary w-full">
                                  <i class="fas fa-check"></i>
                                  Gider Kaydet
                              </button>
                          </form>
                      </div>
                  </div>
              </div>

               Customers Page 
              <div id="customers-page" class="page" style="display: none;">
                  <div class="page-header">
                      <h1 class="page-title">Müşteri Listesi</h1>
                      <p class="page-description">Tüm müşterilerinizi görüntüleyin ve yönetin</p>
                  </div>

                  <div class="card">
                      <div class="card-header">
                          <div class="search-container">
                              <i class="fas fa-search search-icon"></i>
                              <input type="text" id="customerSearch" class="search-input" placeholder="Müşteri ara..." onkeyup="searchCustomers()">
                          </div>
                      </div>
                      <div class="card-content">
                          <div id="customersList"></div>
                      </div>
                  </div>
              </div>

               Reports Page 
              <div id="reports-page" class="page" style="display: none;">
                  <div class="page-header">
                      <h1 class="page-title">Raporlar</h1>
                      <p class="page-description">Detaylı raporlar ve analizler</p>
                  </div>

                  <div class="card">
                      <div class="card-content">
                          <div class="form-row">
                              <div class="form-group">
                                  <label for="reportType">Rapor Türü</label>
                                  <select id="reportType">
                                      <option value="daily">Günlük</option>
                                      <option value="monthly">Aylık</option>
                                      <option value="yearly">Yıllık</option>
                                  </select>
                              </div>
                              <div class="form-group">
                                  <label for="reportDate">Tarih</label>
                                  <input type="date" id="reportDate">
                              </div>
                          </div>
                          <div class="d-flex gap-2 mb-3">
                              <button class="btn btn-primary ripple-primary" onclick="generateReport()">
                                  <i class="fas fa-chart-bar"></i>
                                  Rapor Oluştur
                              </button>
                              <button class="btn btn-secondary ripple" onclick="downloadReport()">
                                  <i class="fas fa-download"></i>
                                  Rapor İndir
                              </button>
                          </div>
                          
                          <div id="reportContent"></div>
                      </div>
                  </div>
              </div>

               Data Management Page 
              <div id="data-page" class="page" style="display: none;">
                  <div class="page-header">
                      <h1 class="page-title">Veri Yönetimi</h1>
                      <p class="page-description">Verilerinizi yönetin ve yedekleyin</p>
                  </div>

                  <div class="card">
                      <div class="card-content">
                          <div class="form-group">
                              <button class="btn btn-primary ripple-primary w-full mb-2" onclick="selectDataFile()">
                                  <i class="fas fa-folder-open"></i>
                                  Veri Dosyası Seç
                              </button>
                              <p class="page-description">Bilgisayarınızdan bir JSON veri dosyası seçin</p>
                          </div>
                          
                          <div class="form-group">
                              <button class="btn btn-success ripple-success w-full mb-2" onclick="saveDataToFile()">
                                  <i class="fas fa-save"></i>
                                  Verileri Kaydet
                              </button>
                              <p class="page-description">Mevcut verileri seçili dosyaya kaydeder</p>
                          </div>
                          
                          <div class="form-group">
                              <button class="btn btn-warning ripple-warning w-full mb-2" onclick="createNewDataFile()">
                                  <i class="fas fa-file-plus"></i>
                                  Yeni Dosya Oluştur
                              </button>
                              <p class="page-description">Yeni bir veri dosyası oluşturur</p>
                          </div>
                          
                          <div class="form-group">
                              <button class="btn btn-danger ripple-danger w-full mb-2" onclick="clearAllData()">
                                  <i class="fas fa-trash"></i>
                                  Tüm Verileri Temizle
                              </button>
                              <p class="page-description">⚠️ Bu işlem geri alınamaz!</p>
                          </div>

                          <div id="fileInfo" class="card" style="display: none; margin-top: 24px;">
                              <div class="card-header">
                                  <h3 class="card-title">
                                      <i class="fas fa-file-alt"></i>
                                      Dosya Bilgileri
                                  </h3>
                              </div>
                              <div class="card-content">
                                  <p><strong>Seçili Dosya:</strong> <span id="selectedFileName">-</span></p>
                                  <p><strong>Son Güncelleme:</strong> <span id="lastUpdate">-</span></p>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>

               Settings Page 
              <div id="settings-page" class="page" style="display: none;">
                  <div class="page-header">
                      <h1 class="page-title">
                          <i class="fas fa-cog"></i>
                          Ayarlar
                      </h1>
                      <p class="page-description">Uygulama ayarlarını ve kişiselleştirmeleri yönetin</p>
                  </div>

                  <div class="card mb-3">
                      <div class="card-header">
                          <h3 class="card-title">Tema Ayarları</h3>
                          <p class="card-description">Uygulamanın görünümünü değiştirin</p>
                      </div>
                      <div class="card-content">
                          <div class="form-group">
                              <label for="themeSelect">Tema Seçimi</label>
                              <select id="themeSelect" onchange="setTheme(this.value)">
                                  <option value="default-light">Varsayılan (Açık)</option>
                                  <option value="default-dark">Varsayılan (Koyu)</option>
                                  <option value="modern-light">Modern (Açık)</option>
                                  <option value="modern-dark">Modern (Koyu)</option>
                                  <option value="minimal-light">Minimal (Açık)</option>
                                  <option value="minimal-dark">Minimal (Koyu)</option>
                              </select>
                          </div>
                      </div>
                  </div>

                  <div class="card mb-3">
                      <div class="card-header">
                          <h3 class="card-title">Uygulama Ayarları</h3>
                          <p class="card-description">Genel uygulama davranışlarını yapılandırın</p>
                      </div>
                      <div class="card-content">
                          <div class="form-group">
                              <label for="adminCodeSetting">Yönetici Kodu</label>
                              <input type="password" id="adminCodeSetting" maxlength="3" placeholder="Yeni yönetici kodu">
                              <button class="btn btn-primary ripple-primary mt-2" onclick="updateAdminCode()">
                                  <i class="fas fa-save"></i>
                                  Kodu Güncelle
                              </button>
                              <p class="page-description mt-1">Yönetici paneline erişim için kullanılan kod.</p>
                          </div>
                          <div class="form-group">
                              <label for="currencySelect">Varsayılan Para Birimi</label>
                              <select id="currencySelect" onchange="updateCurrencySymbol(this.value)">
                                  <option value="₺">Türk Lirası (₺)</option>
                                  <option value="$">Dolar ($)</option>
                                  <option value="€">Euro (€)</option>
                              </select>
                              <p class="page-description mt-1">Uygulamada kullanılan varsayılan para birimi sembolü.</p>
                          </div>
                          <div class="form-group">
                              <label for="languageSelect">Dil</label>
                              <select id="languageSelect" onchange="setLanguage(this.value)">
                                  <option value="tr">Türkçe</option>
                                  <option value="en">English</option>
                              </select>
                              <p class="page-description mt-1">Uygulama arayüzünün dili.</p>
                          </div>
                      </div>
                  </div>

                  <div class="card">
                      <div class="card-header">
                          <h3 class="card-title">Çalışan Yönetimi</h3>
                          <p class="card-description">Çalışan kodlarını ekleyin veya düzenleyin.</p>
                          <button class="btn btn-primary ripple-primary" onclick="showAddEmployeeModal()">
                              <i class="fas fa-user-plus"></i>
                              Yeni Çalışan Ekle
                          </button>
                      </div>
                      <div class="card-content">
                          <div class="employee-grid" id="settingsEmployeeGrid">
                               Employees will be loaded here 
                          </div>
                      </div>
                  </div>
              </div>

          </main>
      </div>

       Admin Panel Page 
      <div id="adminPage" class="admin-page">
          <main class="page-content">
              <div class="page-header">
                  <h1 class="page-title">
                      <i class="fas fa-shield-alt"></i>
                      Yönetici Paneli
                  </h1>
                  <p class="page-description">Gelişmiş işlem ve analiz merkezi</p>
              </div>

              <div class="admin-nav">
                  <button class="admin-nav-btn ripple active" onclick="showAdminSection('overview')">
                      <i class="fas fa-th-large"></i>
                      Genel Bakış
                  </button>
                  <button class="admin-nav-btn ripple" onclick="showAdminSection('sales')">
                      <i class="fas fa-shopping-cart"></i>
                      Satış Yönetimi
                  </button>
                  <button class="admin-nav-btn ripple" onclick="showAdminSection('expenses')">
                      <i class="fas fa-receipt"></i>
                      Gider Yönetimi
                  </button>
                  <button class="admin-nav-btn ripple" onclick="showAdminSection('employees')">
                      <i class="fas fa-users"></i>
                      Çalışan Yönetimi
                  </button>
                  <button class="admin-nav-btn ripple" onclick="showAdminSection('analytics')">
                      <i class="fas fa-chart-bar"></i>
                      Analitik
                  </button>
                  <button class="admin-nav-btn ripple" onclick="goBackToMain()">
                      <i class="fas fa-arrow-left"></i>
                      Ana Sayfaya Dön
                  </button>
              </div>

               Admin Overview 
              <div id="adminOverview" class="admin-content active">
                  <div class="card">
                      <div class="card-header">
                          <h3 class="card-title">Genel Bakış</h3>
                          <div class="form-group" style="margin: 0; max-width: 200px;">
                              <input type="date" id="adminDateFilter" onchange="filterAdminData()">
                          </div>
                      </div>
                      <div class="card-content">
                          <div class="stats-grid">
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">Günlük Satış</span>
                                      <i class="fas fa-lira-sign stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="adminTotalSales">0</div>
                              </div>
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">Günlük Gider</span>
                                      <i class="fas fa-receipt stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="adminTotalExpenses">0</div>
                              </div>
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">Günlük Kar</span>
                                      <i class="fas fa-chart-line stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="adminNetProfit">0</div>
                              </div>
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">İşlem Sayısı</span>
                                      <i class="fas fa-list stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="adminTotalTransactions">0</div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>

               Admin Sales Management 
              <div id="adminSales" class="admin-content">
                  <div class="card">
                      <div class="card-header">
                          <h3 class="card-title">Satış İşlemleri</h3>
                          <div class="form-group" style="margin: 0; max-width: 200px;">
                              <input type="date" id="salesDateFilter" onchange="loadAdminSales()">
                          </div>
                      </div>
                      <div class="card-content" style="padding: 0;">
                          <div class="table-container">
                              <table class="table">
                                  <thead>
                                      <tr>
                                          <th>Tarih</th>
                                          <th>Müşteri</th>
                                          <th>Tutar</th>
                                          <th>Ödeme</th>
                                          <th>Çalışan</th>
                                          <th>İşlemler</th>
                                      </tr>
                                  </thead>
                                  <tbody id="adminSalesTable">
                                  </tbody>
                              </table>
                          </div>
                      </div>
                  </div>
              </div>

               Admin Expenses Management 
              <div id="adminExpenses" class="admin-content">
                  <div class="card">
                      <div class="card-header">
                          <h3 class="card-title">Gider İşlemleri</h3>
                          <div class="form-group" style="margin: 0; max-width: 200px;">
                              <input type="date" id="expensesDateFilter" onchange="loadAdminExpenses()">
                          </div>
                      </div>
                      <div class="card-content" style="padding: 0;">
                          <div class="table-container">
                              <table class="table">
                                  <thead>
                                      <tr>
                                          <th>Tarih</th>
                                          <th>Açıklama</th>
                                          <th>Kategori</th>
                                          <th>Tutar</th>
                                          <th>Çalışan</th>
                                          <th>İşlemler</th>
                                      </tr>
                                  </thead>
                                  <tbody id="adminExpensesTable">
                                  </tbody>
                              </table>
                          </div>
                      </div>
                  </div>
              </div>

               Employee Management 
              <div id="adminEmployees" class="admin-content">
                  <div class="card">
                      <div class="card-header">
                          <h3 class="card-title">Çalışan Yönetimi</h3>
                          <button class="btn btn-primary ripple-primary" onclick="showAddEmployeeModal()">
                              <i class="fas fa-user-plus"></i>
                              Yeni Çalışan Ekle
                          </button>
                      </div>
                      <div class="card-content">
                          <div class="employee-grid" id="employeeGrid">
                               Employees will be loaded here 
                          </div>
                      </div>
                  </div>
              </div>

               Analytics 
              <div id="adminAnalytics" class="admin-content">
                  <div class="card">
                      <div class="card-header">
                          <h3 class="card-title">Analitik ve İstatistikler</h3>
                      </div>
                      <div class="card-content">
                          <div class="stats-grid">
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">Ortalama Satış</span>
                                      <i class="fas fa-chart-line stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="analyticsAvgSale">0</div>
                              </div>
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">En Aktif Çalışan</span>
                                      <i class="fas fa-user stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="analyticsTopEmployee">-</div>
                              </div>
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">Aylık Büyüme</span>
                                      <i class="fas fa-trending-up stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="analyticsMonthlyGrowth">0%</div>
                              </div>
                              <div class="stat-card ripple">
                                  <div class="stat-header">
                                      <span class="stat-title">Toplam Müşteri</span>
                                      <i class="fas fa-users stat-icon"></i>
                                  </div>
                                  <div class="stat-value" id="analyticsCustomerCount">0</div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          </main>
      </div>
  </div>

   Modals 
  
   Admin Login Modal 
  <div id="adminLoginModal" class="modal">
      <div class="modal-content">
          <span class="close ripple" onclick="closeAdminLogin()">&times;</span>
          <h3 class="card-title mb-3">Yönetici Girişi</h3>
          <div class="form-group">
              <label for="adminCode">Yönetici Kodu</label>
              <input type="password" id="adminCode" maxlength="3" placeholder="Kodu girin">
          </div>
          <button class="btn btn-danger ripple-danger w-full" onclick="verifyAdmin()">
              <i class="fas fa-sign-in-alt"></i>
              Giriş Yap
          </button>
      </div>
  </div>

   Add Employee Modal 
  <div id="addEmployeeModal" class="modal">
      <div class="modal-content">
          <span class="close ripple" onclick="closeAddEmployeeModal()">&times;</span>
          <h3 class="card-title mb-3">Yeni Çalışan Ekle</h3>
          <form id="addEmployeeForm">
              <div class="form-group">
                  <label for="employeeName">Çalışan Adı</label>
                  <input type="text" id="employeeName" required>
              </div>
              <div class="form-group">
                  <label for="employeeCodeNew">Çalışan Kodu (3 haneli)</label>
                  <input type="text" id="employeeCodeNew" maxlength="3" required>
              </div>
              <button type="submit" class="btn btn-primary ripple-primary w-full">
                  <i class="fas fa-user-plus"></i>
                  Çalışan Ekle
              </button>
          </form>
      </div>
  </div>

   Edit Sale Modal 
  <div id="editSaleModal" class="modal">
      <div class="modal-content">
          <span class="close ripple" onclick="closeEditSale()">&times;</span>
          <h3 class="card-title mb-3">Satış Düzenle</h3>
          <form id="editSaleForm">
              <div class="form-row">
                  <div class="form-group">
                      <label for="editCustomerName">Müşteri Adı</label>
                      <input type="text" id="editCustomerName" required>
                  </div>
                  <div class="form-group">
                      <label for="editCustomerSurname">Müşteri Soyadı</label>
                      <input type="text" id="editCustomerSurname" required>
                  </div>
              </div>
              <div class="form-row">
                  <div class="form-group">
                      <label for="editCustomerPhone">Telefon</label>
                      <input type="tel" id="editCustomerPhone" required>
                  </div>
                  <div class="form-group">
                      <label for="editCarpetArea">m²</label>
                      <input type="number" id="editCarpetArea" step="0.01" required>
                  </div>
              </div>
              <div class="form-row">
                  <div class="form-group">
                      <label for="editSalePrice">Fiyat (<span id="currencySymbol4">₺</span>)</label>
                      <input type="number" id="editSalePrice" step="0.01" required>
                  </div>
                  <div class="form-group">
                      <label for="editPaidAmount">Ödenen (<span id="currencySymbol5">₺</span>)</label>
                      <input type="number" id="editPaidAmount" step="0.01" required>
                  </div>
              </div>
              <button type="submit" class="btn btn-primary ripple-primary w-full">
                  <i class="fas fa-check"></i>
                  Güncelle
              </button>
          </form>
      </div>
  </div>

   Edit Expense Modal 
  <div id="editExpenseModal" class="modal">
      <div class="modal-content">
          <span class="close ripple" onclick="closeEditExpense()">&times;</span>
          <h3 class="card-title mb-3">Gider Düzenle</h3>
          <form id="editExpenseForm">
              <div class="form-group">
                  <label for="editExpenseDescription">Açıklama</label>
                  <input type="text" id="editExpenseDescription" required>
              </div>
              <div class="form-row">
                  <div class="form-group">
                      <label for="editExpenseAmount">Tutar (<span id="currencySymbol6">₺</span>)</label>
                      <input type="number" id="editExpenseAmount" step="0.01" required>
                  </div>
                  <div class="form-group">
                      <label for="editExpenseCategory">Kategori</label>
                      <select id="editExpenseCategory" required>
                          <option value="kira">Kira</option>
                          <option value="elektrik">Elektrik</option>
                          <option value="su">Su</option>
                          <option value="telefon">Telefon</option>
                          <option value="malzeme">Malzeme</option>
                          <option value="personel">Personel</option>
                          <option value="diger">Diğer</option>
                      </select>
                  </div>
              </div>
              <button type="submit" class="btn btn-primary ripple-primary w-full">
                  <i class="fas fa-check"></i>
                  Güncelle
              </button>
          </form>
      </div>
  </div>

   Customer Details Modal 
  <div id="customerModal" class="modal">
      <div class="modal-content">
          <span class="close ripple" onclick="closeCustomerModal()">&times;</span>
          <div id="customerDetails"></div>
      </div>
  </div>

   Pending Payments Modal 
  <div id="paymentsModal" class="modal">
      <div class="modal-content">
          <span class="close ripple" onclick="closePaymentsModal()">&times;</span>
          <h3 class="card-title mb-3">Bekleyen Ödemeler</h3>
          <div id="pendingPaymentsList"></div>
      </div>
  </div>

   Payment Modal 
  <div id="paymentModal" class="modal">
      <div class="modal-content">
          <span class="close ripple" onclick="closePaymentModal()">&times;</span>
          <h3 class="card-title mb-3">Ödeme Al</h3>
          <div id="paymentForm">
              <div class="form-group">
                  <label>Müşteri</label>
                  <div id="paymentCustomerInfo" class="card-description"></div>
              </div>
              <div class="form-group">
                  <label>Toplam Borç</label>
                  <div id="paymentTotalDebt" style="color: var(--danger-color); font-weight: 600; font-size: 18px;"></div>
              </div>
              <div class="form-group">
                  <label for="paymentAmount">Ödeme Tutarı (<span id="currencySymbol7">₺</span>)</label>
                  <input type="number" id="paymentAmount" step="0.01" required>
              </div>
              <div class="form-group">
                  <label>Ödeme Türü</label>
                  <div class="payment-options">
                      <div class="payment-option ripple selected" onclick="selectDebtPaymentType('cash')">
                          <i class="fas fa-money-bill-wave"></i>
                          <div>Nakit</div>
                      </div>
                      <div class="payment-option ripple" onclick="selectDebtPaymentType('card')">
                          <i class="fas fa-credit-card"></i>
                          <div>Kart</div>
                      </div>
                  </div>
              </div>
              <div class="form-group">
                  <label for="paymentEmployeeCode">Çalışan Kodu</label>
                  <input type="password" id="paymentEmployeeCode" maxlength="3" required>
              </div>
              <button class="btn btn-primary ripple-primary w-full" onclick="processPayment()">
                  <i class="fas fa-check"></i>
                  Ödeme Al
              </button>
          </div>
      </div>
  </div>

  <script>
      // PWA Variables
      let deferredPrompt;
      let isOnline = navigator.onLine;

      // File System Access API Variables
      let fileHandle = null;
      let isFileSystemSupported = 'showOpenFilePicker' in window;

      // Employee codes - Default employees
      let employees = {
          '222': 'YUSUF',
          '333': 'YUNUS'
      };

      // Admin code
      let ADMIN_CODE = '666'; // Now configurable

      // Initialize data
      let salesData = [];
      let expensesData = [];
      let customersData = [];
      let debtsData = [];
      let paymentsData = [];

      let selectedPaymentType = 'cash';
      let selectedPaidPaymentType = 'cash';
      let selectedDebtPaymentType = 'cash';
      let currentPaymentCustomer = null;
      let isAdminLoggedIn = false;
      let currentEditSaleId = null;
      let currentEditExpenseId = null;
      let currentDashboardPeriod = 'today';
      let selectedCustomerIndex = -1;
      let currentCurrencySymbol = '₺'; // Default currency symbol
      let currentLanguage = 'tr'; // Default language

      // Customer autocomplete variables
      let customerSuggestions = [];
      let isShowingSuggestions = false;

      // Mobile menu toggle
      const menuToggle = document.getElementById('menuToggle');
      const sidebarClose = document.getElementById('sidebarClose');
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('overlay');

      function toggleSidebar() {
          sidebar.classList.toggle('open');
          overlay.classList.toggle('show');
      }

      menuToggle.addEventListener('click', toggleSidebar);
      sidebarClose.addEventListener('click', toggleSidebar);
      overlay.addEventListener('click', toggleSidebar);

      // Navigation
      const navItems = document.querySelectorAll('.nav-item[data-page]');
      const pages = document.querySelectorAll('.page');

      navItems.forEach(item => {
          item.addEventListener('click', (e) => {
              e.preventDefault();
              
              // Remove active class from all nav items
              navItems.forEach(nav => nav.classList.remove('active'));
              
              // Add active class to clicked item
              item.classList.add('active');
              
              // Hide all pages
              pages.forEach(page => page.style.display = 'none');
              
              // Show selected page
              const pageId = item.getAttribute('data-page') + '-page';
              const targetPage = document.getElementById(pageId);
              if (targetPage) {
                  targetPage.style.display = 'block';
              }

              // Load page-specific data
              const pageName = item.getAttribute('data-page');
              if (pageName === 'dashboard') {
                  updateDashboard();
              } else if (pageName === 'customers') {
                  loadCustomers();
              } else if (pageName === 'settings') {
                  loadSettings();
              }

              // Close sidebar on mobile
              if (window.innerWidth < 1024) {
                  toggleSidebar();
              }
          });
      });

      // Tabs functionality
      const tabTriggers = document.querySelectorAll('.tab-trigger');
      const tabContents = document.querySelectorAll('.tab-content');

      tabTriggers.forEach(trigger => {
          trigger.addEventListener('click', () => {
              const tabId = trigger.getAttribute('data-tab') + '-tab';
              
              // Remove active class from all triggers and contents
              tabTriggers.forEach(t => t.classList.remove('active'));
              tabContents.forEach(c => c.classList.remove('active'));
              
              // Add active class to clicked trigger and corresponding content
              trigger.classList.add('active');
              const targetTab = document.getElementById(tabId);
              if (targetTab) {
                  targetTab.classList.add('active');
              }

              // Update dashboard period based on tab
              const tabName = trigger.getAttribute('data-tab');
              if (tabName === 'today') {
                  currentDashboardPeriod = 'today';
              } else if (tabName === 'week') {
                  currentDashboardPeriod = 'week';
              } else if (tabName === 'month') {
                  currentDashboardPeriod = 'month';
              }
              updateDashboard();
          });
      });

      // File System Access API Functions
      async function selectDataFile() {
          if (!isFileSystemSupported) {
              showAlert('File System Access API bu tarayıcıda desteklenmiyor!', 'error');
              return;
          }

          try {
              [fileHandle] = await window.showOpenFilePicker({
                  types: [{
                      description: 'JSON files',
                      accept: {
                          'application/json': ['.json']
                      }
                  }],
                  excludeAcceptAllOption: true,
                  multiple: false
              });

              // Save file handle to localStorage for persistence
              // Note: This only saves metadata, actual handle cannot be restored directly
              localStorage.setItem('theLengFileHandleName', fileHandle.name);

              await loadDataFromFile();
              updateFileInfo();
              showFileStatus('Dosya seçildi ve yüklendi', 'success');
          } catch (error) {
              if (error.name !== 'AbortError') {
                  console.error('Dosya seçme hatası:', error);
                  showAlert('Dosya seçme hatası: ' + error.message, 'error');
              }
          }
      }

      async function loadDataFromFile() {
          if (!fileHandle) return;

          try {
              const file = await fileHandle.getFile();
              const contents = await file.text();
              
              if (contents.trim() === '') {
                  initializeEmptyData();
              } else {
                  const data = JSON.parse(contents);
                  
                  salesData = data.sales || [];
                  expensesData = data.expenses || [];
                  customersData = data.customers || [];
                  debtsData = data.debts || [];
                  paymentsData = data.payments || [];
                  
                  // Load employees if exists
                  if (data.employees) {
                      employees = { ...employees, ...data.employees };
                  }
                  // Load admin code if exists
                  if (data.adminCode) {
                      ADMIN_CODE = data.adminCode;
                  }
                  // Load currency symbol if exists
                  if (data.currencySymbol) {
                      currentCurrencySymbol = data.currencySymbol;
                  }
                  // Load language if exists
                  if (data.language) {
                      currentLanguage = data.language;
                  }
              }

              updateDashboard();
              updateDebtBadge();
              updateCurrencySymbol(currentCurrencySymbol); // Apply loaded currency
              setLanguage(currentLanguage); // Apply loaded language
              if (isAdminLoggedIn) {
                  loadAdminData();
                  loadEmployees();
              }
              showAlert('Veriler dosyadan yüklendi!', 'success');
          } catch (error) {
              console.error('Dosya okuma hatası:', error);
              showAlert('Dosya okuma hatası: ' + error.message, 'error');
          }
      }

      async function saveDataToFile() {
          if (!fileHandle) {
              showAlert('Önce bir dosya seçin!', 'error');
              return;
          }

          try {
              const data = {
                  sales: salesData,
                  expenses: expensesData,
                  customers: customersData,
                  debts: debtsData,
                  payments: paymentsData,
                  employees: employees,
                  adminCode: ADMIN_CODE, // Save admin code
                  currencySymbol: currentCurrencySymbol, // Save currency symbol
                  language: currentLanguage, // Save language
                  lastUpdate: new Date().toISOString()
              };

              const writable = await fileHandle.createWritable();
              await writable.write(JSON.stringify(data, null, 2));
              await writable.close();

              updateFileInfo();
              showFileStatus('Veriler kaydedildi', 'success');
          } catch (error) {
              console.error('Dosya yazma hatası:', error);
              showAlert('Dosya yazma hatası: ' + error.message, 'error');
              showFileStatus('Kaydetme hatası', 'error');
          }
      }

      async function createNewDataFile() {
          if (!isFileSystemSupported) {
              showAlert('File System Access API bu tarayıcıda desteklenmiyor!', 'error');
              return;
          }

          try {
              fileHandle = await window.showSaveFilePicker({
                  types: [{
                      description: 'JSON files',
                      accept: {
                          'application/json': ['.json']
                      }
                  }],
                  suggestedName: `the-leng-data-${new Date().toISOString().split('T')[0]}.json`
              });

              // Save file handle name to localStorage for persistence
              localStorage.setItem('theLengFileHandleName', fileHandle.name);

              await saveDataToFile();
              updateFileInfo();
              showFileStatus('Yeni dosya oluşturuldu', 'success');
          } catch (error) {
              if (error.name !== 'AbortError') {
                  console.error('Dosya oluşturma hatası:', error);
                  showAlert('Dosya oluşturma hatası: ' + error.message, 'error');
              }
          }
      }

      function initializeEmptyData() {
          salesData = [];
          expensesData = [];
          customersData = [];
          debtsData = [];
          paymentsData = [];
      }

      function updateFileInfo() {
          if (fileHandle) {
              document.getElementById('selectedFileName').textContent = fileHandle.name;
              document.getElementById('lastUpdate').textContent = new Date().toLocaleString('tr-TR');
              document.getElementById('fileInfo').style.display = 'block';
          }
      }

      function showFileStatus(message, type) {
          const statusEl = document.getElementById('fileStatus');
          statusEl.textContent = message;
          statusEl.className = `file-status ${type}`;
          statusEl.style.display = 'block';
          
          setTimeout(() => {
              statusEl.style.display = 'none';
          }, 3000);
      }

      // Auto-save function
      async function autoSave() {
          if (fileHandle) {
              try {
                  await saveDataToFile();
              } catch (error) {
                  console.error('Auto-save failed:', error);
                  showFileStatus('Otomatik kaydetme hatası', 'error');
              }
          }
      }

      // Initialize PWA and load saved file handle
      async function initApp() {
          // Check File System Access API support
          if (!isFileSystemSupported) {
              showFileStatus('File System API desteklenmiyor', 'warning');
          } else {
              showFileStatus('File System API hazır', 'success');
              
              // Try to restore file handle from localStorage
              const savedFileName = localStorage.getItem('theLengFileHandleName');
              if (savedFileName && isFileSystemSupported) {
                  // Note: We can't directly restore file handles from localStorage
                  // This is a limitation of the File System Access API for security reasons
                  showFileStatus(`Önceki dosyanızı tekrar seçin: ${savedFileName}`, 'warning');
              }
          }

          loadTheme();
          loadSettingsFromLocalStorage(); // Load other settings
          updateDashboard();
          updateDebtBadge();
          document.getElementById('reportDate').value = new Date().toISOString().split('T')[0];
          document.getElementById('adminDateFilter').value = new Date().toISOString().split('T')[0];
          document.getElementById('salesDateFilter').value = new Date().toISOString().split('T')[0];
          document.getElementById('expensesDateFilter').value = new Date().toISOString().split('T')[0];
      }

      // Theme management
      const themes = ['default-light', 'default-dark', 'modern-light', 'modern-dark', 'minimal-light', 'minimal-dark'];
      let currentThemeIndex = 0;

      function setTheme(themeName) {
          document.body.setAttribute('data-theme', themeName);
          localStorage.setItem('theLengTheme', themeName);
          currentThemeIndex = themes.indexOf(themeName);
          if (currentThemeIndex === -1) currentThemeIndex = 0; // Fallback
          updateThemeIcon();
          updateSettingsThemeSelect();
      }

      function cycleTheme() {
          currentThemeIndex = (currentThemeIndex + 1) % themes.length;
          setTheme(themes[currentThemeIndex]);
      }

      function loadTheme() {
          const savedTheme = localStorage.getItem('theLengTheme');
          if (savedTheme && themes.includes(savedTheme)) {
              setTheme(savedTheme);
          } else {
              setTheme('default-light'); // Default fallback
          }
      }

      function updateThemeIcon() {
          const themeToggleIcon = document.getElementById('themeToggleIcon');
          if (themeToggleIcon) {
              // Icon doesn't change based on light/dark, but indicates theme switching
              themeToggleIcon.className = 'fas fa-palette'; 
          }
      }

      function updateSettingsThemeSelect() {
          const themeSelect = document.getElementById('themeSelect');
          if (themeSelect) {
              themeSelect.value = document.body.getAttribute('data-theme');
          }
      }

      // Settings Management
      function loadSettingsFromLocalStorage() {
          const savedAdminCode = localStorage.getItem('theLengAdminCode');
          if (savedAdminCode) {
              ADMIN_CODE = savedAdminCode;
          }
          const savedCurrency = localStorage.getItem('theLengCurrency');
          if (savedCurrency) {
              currentCurrencySymbol = savedCurrency;
          }
          const savedLanguage = localStorage.getItem('theLengLanguage');
          if (savedLanguage) {
              currentLanguage = savedLanguage;
          }
          updateCurrencySymbol(currentCurrencySymbol);
          setLanguage(currentLanguage);
      }

      function loadSettings() {
          document.getElementById('adminCodeSetting').value = ADMIN_CODE;
          document.getElementById('currencySelect').value = currentCurrencySymbol;
          document.getElementById('languageSelect').value = currentLanguage;
          updateSettingsThemeSelect();
          loadEmployees('settingsEmployeeGrid'); // Load employees for settings page
      }

      async function updateAdminCode() {
          const newCode = document.getElementById('adminCodeSetting').value;
          if (newCode.length === 3) {
              ADMIN_CODE = newCode;
              localStorage.setItem('theLengAdminCode', newCode);
              await autoSave(); // Save to file if fileHandle exists
              showAlert('Yönetici kodu güncellendi!', 'success');
          } else {
              showAlert('Yönetici kodu 3 haneli olmalıdır!', 'error');
          }
      }

      function updateCurrencySymbol(symbol) {
          currentCurrencySymbol = symbol;
          localStorage.setItem('theLengCurrency', symbol);
          document.querySelectorAll('[id^="currencySymbol"]').forEach(span => {
              span.textContent = symbol;
          });
          updateDashboard(); // Recalculate and display with new currency
          if (isAdminLoggedIn) loadAdminData();
      }

      const translations = {
          tr: {
              'Panel': 'Panel',
              'Satış': 'Satış',
              'Gider': 'Gider',
              'Müşteri': 'Müşteri',
              'Rapor': 'Rapor',
              'Veri': 'Veri',
              'Yönetici': 'Yönetici',
              'Ayarlar': 'Ayarlar',
              'Genel Durum': 'Genel Durum',
              'Satış Girişi': 'Satış Girişi',
              'Gider Girişi': 'Gider Girişi',
              'Müşteri Listesi': 'Müşteri Listesi',
              'Raporlar': 'Raporlar',
              'Veri Yönetimi': 'Veri Yönetimi',
              'Ayarlar': 'Ayarlar',
              'Yönetici Paneli': 'Yönetici Paneli',
              'Yeni Çalışan Ekle': 'Yeni Çalışan Ekle',
              'Çalışan Adı': 'Çalışan Adı',
              'Çalışan Kodu (3 haneli)': 'Çalışan Kodu (3 haneli)',
              'Çalışan Ekle': 'Çalışan Ekle',
              'Sil': 'Sil',
              'Giriş Yap': 'Giriş Yap',
              'Geçersiz yönetici kodu!': 'Geçersiz yönetici kodu!',
              'Yönetici paneline giriş yapıldı!': 'Yönetici paneline giriş yapıldı!',
              'Satış başarıyla kaydedildi!': 'Satış başarıyla kaydedildi!',
              'Gider başarıyla kaydedildi!': 'Gider başarıyla kaydedildi!',
              'Ödeme başarıyla alındı!': 'Ödeme başarıyla alındı!',
              'Satış güncellendi!': 'Satış güncellendi!',
              'Gider güncellendi!': 'Gider güncellendi!',
              'Satış silindi!': 'Satış silindi!',
              'Gider silindi!': 'Gider silindi!',
              'Tüm veriler temizlendi!': 'Tüm veriler temizlendi!',
              'Bu kod zaten kullanılıyor!': 'Bu kod zaten kullanılıyor!',
              'Yeni çalışan eklendi!': 'Yeni çalışan eklendi!',
              'Çalışan silindi!': 'Çalışan silindi!',
              'Geçersiz çalışan kodu!': 'Geçersiz çalışan kodu!',
              'Geçersiz ödeme tutarı!': 'Geçersiz ödeme tutarı!',
              'Önce rapor oluşturun!': 'Önce rapor oluşturun!',
              'Önce bir dosya seçin!': 'Önce bir dosya seçin!',
              'Dosya seçildi ve yüklendi': 'Dosya seçildi ve yüklendi',
              'Veriler dosyadan yüklendi!': 'Veriler dosyadan yüklendi!',
              'Veriler kaydedildi': 'Veriler kaydedildi',
              'Yeni dosya oluşturuldu': 'Yeni dosya oluşturuldu',
              'Otomatik kaydetme hatası': 'Otomatik kaydetme hatası',
              'Kaydetme hatası': 'Kaydetme hatası',
              'File System API desteklenmiyor': 'File System API desteklenmiyor',
              'File System API hazır': 'File System API hazır',
              'Önceki dosyayı tekrar seçin': 'Önceki dosyayı tekrar seçin',
              'Dosya seçme hatası: ': 'Dosya seçme hatası: ',
              'Dosya okuma hatası: ': 'Dosya okuma hatası: ',
              'Dosya oluşturma hatası: ': 'Dosya oluşturma hatası: ',
              'Yönetici kodu güncellendi!': 'Yönetici kodu güncellendi!',
              'Yönetici kodu 3 haneli olmalıdır!': 'Yönetici kodu 3 haneli olmalıdır!',
              'Uygulama ayarlarını ve kişiselleştirmeleri yönetin': 'Uygulama ayarlarını ve kişiselleştirmeleri yönetin',
              'Tema Ayarları': 'Tema Ayarları',
              'Uygulamanın görünümünü değiştirin': 'Uygulamanın görünümünü değiştirin',
              'Tema Seçimi': 'Tema Seçimi',
              'Varsayılan (Açık)': 'Varsayılan (Açık)',
              'Varsayılan (Koyu)': 'Varsayılan (Koyu)',
              'Modern (Açık)': 'Modern (Açık)',
              'Modern (Koyu)': 'Modern (Koyu)',
              'Minimal (Açık)': 'Minimal (Açık)',
              'Minimal (Koyu)': 'Minimal (Koyu)',
              'Uygulama Ayarları': 'Uygulama Ayarları',
              'Genel uygulama davranışlarını yapılandırın': 'Genel uygulama davranışlarını yapılandırın',
              'Yönetici Kodu': 'Yönetici Kodu',
              'Yeni yönetici kodu': 'Yeni yönetici kodu',
              'Kodu Güncelle': 'Kodu Güncelle',
              'Yönetici paneline erişim için kullanılan kod.': 'Yönetici paneline erişim için kullanılan kod.',
              'Varsayılan Para Birimi': 'Varsayılan Para Birimi',
              'Uygulamada kullanılan varsayılan para birimi sembolü.': 'Uygulamada kullanılan varsayılan para birimi sembolü.',
              'Dil': 'Dil',
              'Uygulama arayüzünün dili.': 'Uygulama arayüzünün dili.',
              'Çalışan Yönetimi': 'Çalışan Yönetimi',
              'Çalışan kodlarını ekleyin veya düzenleyin.': 'Çalışan kodlarını ekleyin veya düzenleyin.',
              'Türk Lirası (₺)': 'Türk Lirası (₺)',
              'Dolar ($)': 'Dolar ($)',
              'Euro (€)': 'Euro (€)',
              'Türkçe': 'Türkçe',
              'English': 'English',
              'Ara...': 'Ara...',
              'Bugün': 'Bugün',
              'Bu Hafta': 'Bu Hafta',
              'Bu Ay': 'Bu Ay',
              'Bugünkü Gelir': 'Bugünkü Gelir',
              'Bugünkü Gider': 'Bugünkü Gider',
              'Net Kar': 'Net Kar',
              'Toplam Borç': 'Toplam Borç',
              'Tüm Zamanlar': 'Tüm Zamanlar',
              'Son İşlemler': 'Son İşlemler',
              'En son gerçekleştirilen işlemler': 'En son gerçekleştirilen işlemler',
              'Tarih': 'Tarih',
              'Tür': 'Tür',
              'Açıklama': 'Açıklama',
              'Tutar': 'Tutar',
              'Ödeme': 'Ödeme',
              'Çalışan': 'Çalışan',
              'Müşteri Adı': 'Müşteri Adı',
              'Müşteri Soyadı': 'Müşteri Soyadı',
              'Telefon Numarası': 'Telefon Numarası',
              'Halı m²': 'Halı m²',
              'Satış Fiyatı': 'Satış Fiyatı',
              'Ödeme Türü': 'Ödeme Türü',
              'Nakit': 'Nakit',
              'Kart': 'Kart',
              'Borç': 'Borç',
              'Ödenen Tutar': 'Ödenen Tutar',
              'Ödenen Kısmın Türü': 'Ödenen Kısmın Türü',
              'Satış Kaydet': 'Satış Kaydet',
              'Gider Açıklaması': 'Gider Açıklaması',
              'Gider Tutarı': 'Gider Tutarı',
              'Kategori': 'Kategori',
              'Kategori Seçin': 'Kategori Seçin',
              'Kira': 'Kira',
              'Elektrik': 'Elektrik',
              'Su': 'Su',
              'Telefon': 'Telefon',
              'Malzeme': 'Malzeme',
              'Personel': 'Personel',
              'Diğer': 'Diğer',
              'Gider Kaydet': 'Gider Kaydet',
              'Müşteri ara...': 'Müşteri ara...',
              'Rapor Türü': 'Rapor Türü',
              'Günlük': 'Günlük',
              'Aylık': 'Aylık',
              'Yıllık': 'Yıllık',
              'Rapor Oluştur': 'Rapor Oluştur',
              'Rapor İndir': 'Rapor İndir',
              'Veri Dosyası Seç': 'Veri Dosyası Seç',
              'Bilgisayarınızdan bir JSON veri dosyası seçin': 'Bilgisayarınızdan bir JSON veri dosyası seçin',
              'Verileri Kaydet': 'Verileri Kaydet',
              'Mevcut verileri seçili dosyaya kaydeder': 'Mevcut verileri seçili dosyaya kaydeder',
              'Yeni Dosya Oluştur': 'Yeni Dosya Oluştur',
              'Yeni bir veri dosyası oluşturur': 'Yeni bir veri dosyası oluşturur',
              'Tüm Verileri Temizle': 'Tüm Verileri Temizle',
              'Bu işlem geri alınamaz!': 'Bu işlem geri alınamaz!',
              'Dosya Bilgileri': 'Dosya Bilgileri',
              'Seçili Dosya:': 'Seçili Dosya:',
              'Son Güncelleme:': 'Son Güncelleme:',
              'Genel Bakış': 'Genel Bakış',
              'Satış Yönetimi': 'Satış Yönetimi',
              'Gider Yönetimi': 'Gider Yönetimi',
              'Analitik': 'Analitik',
              'Ana Sayfaya Dön': 'Ana Sayfaya Dön',
              'Günlük Satış': 'Günlük Satış',
              'Günlük Gider': 'Günlük Gider',
              'Günlük Kar': 'Günlük Kar',
              'İşlem Sayısı': 'İşlem Sayısı',
              'Satış İşlemleri': 'Satış İşlemleri',
              'Müşteri': 'Müşteri',
              'Fiyat': 'Fiyat',
              'İşlemler': 'İşlemler',
              'Gider İşlemleri': 'Gider İşlemleri',
              'Analitik ve İstatistikler': 'Analitik ve İstatistikler',
              'Ortalama Satış': 'Ortalama Satış',
              'En Aktif Çalışan': 'En Aktif Çalışan',
              'Aylık Büyüme': 'Aylık Büyüme',
              'Toplam Müşteri': 'Toplam Müşteri',
              'Yönetici Girişi': 'Yönetici Girişi',
              'Kodu girin': 'Kodu girin',
              'Satış Düzenle': 'Satış Düzenle',
              'Güncelle': 'Güncelle',
              'Gider Düzenle': 'Gider Düzenle',
              'Açıklama': 'Açıklama',
              'Bekleyen Ödemeler': 'Bekleyen Ödemeler',
              'Ödeme Al': 'Ödeme Al',
              'Toplam Borç': 'Toplam Borç',
              'Ödeme Tutarı': 'Ödeme Tutarı',
              'Ödeme Türü': 'Ödeme Türü',
              'Kalan': 'Kalan',
              'Toplam': 'Toplam',
              'Ödenen': 'Ödenen',
              'Alışveriş Geçmişi': 'Alışveriş Geçmişi',
              'Ödeme Geçmişi': 'Ödeme Geçmişi',
              'Telefon:': 'Telefon:',
              'Toplam Alışveriş:': 'Toplam Alışveriş:',
              'Son Alışveriş:': 'Son Alışveriş:',
              'Kalan Borç:': 'Kalan Borç:',
              'm²': 'm²',
              'Ödenen': 'Ödenen',
              'Satış': 'Satış',
              'Ödeme': 'Ödeme',
              'Gider': 'Gider',
              'Günlük Rapor': 'Günlük Rapor',
              'Aylık Rapor': 'Aylık Rapor',
              'Yıllık Rapor': 'Yıllık Rapor',
              'Toplam Gelir': 'Toplam Gelir',
              'Kar': 'Kar',
              'Borç': 'Borç',
              'İşlem Detayları': 'İşlem Detayları',
              'Bekleyen Borçlar': 'Bekleyen Borçlar',
              'Müşteri Adı (F1 ile seç)': 'Müşteri Adı (F1 ile seç)',
              'Çalışan Kodu': 'Çalışan Kodu',
              'Halı m²': 'Halı m²',
              'Satış Fiyatı': 'Satış Fiyatı',
              'Ödenen Tutar': 'Ödenen Tutar',
              'Gider Açıklaması': 'Gider Açıklaması',
              'Gider Tutarı': 'Gider Tutarı',
              'Müşteri ara...': 'Müşteri ara...',
              'Tarih': 'Tarih',
              'Müşteri': 'Müşteri',
              'Tutar': 'Tutar',
              'Ödeme': 'Ödeme',
              'Çalışan': 'Çalışan',
              'Açıklama': 'Açıklama',
              'Kategori': 'Kategori',
              'Telefon': 'Telefon',
              'Fiyat': 'Fiyat',
              'Ödenen': 'Ödenen',
              'Toplam': 'Toplam',
              'Kalan': 'Kalan',
              'Ödeme Tutarı': 'Ödeme Tutarı',
              'Ödeme Türü': 'Ödeme Türü',
              'Çalışan Kodu': 'Çalışan Kodu',
              'Bu çalışanı silmek istediğinizden emin misiniz?': 'Bu çalışanı silmek istediğinizden emin misiniz?',
              'Bu satışı silmek istediğinizden emin misiniz?': 'Bu satışı silmek istediğinizden emin misiniz?',
              'Bu gideri silmek istediğinizden emin misiniz?': 'Bu gideri silmek istediğinizden emin misiniz?',
              'Tüm verileri silmek istediğinizden emin misiniz? Bu işlem geri alınamaz!': 'Tüm verileri silmek istediğinizden emin misiniz? Bu işlem geri alınamaz!'
          },
          en: {
              'Panel': 'Dashboard',
              'Satış': 'Sales',
              'Gider': 'Expenses',
              'Müşteri': 'Customers',
              'Rapor': 'Reports',
              'Veri': 'Data',
              'Yönetici': 'Admin',
              'Ayarlar': 'Settings',
              'Genel Durum': 'Overview',
              'Satış Girişi': 'New Sale',
              'Gider Girişi': 'New Expense',
              'Müşteri Listesi': 'Customer List',
              'Raporlar': 'Reports',
              'Veri Yönetimi': 'Data Management',
              'Ayarlar': 'Settings',
              'Yönetici Paneli': 'Admin Panel',
              'Yeni Çalışan Ekle': 'Add New Employee',
              'Çalışan Adı': 'Employee Name',
              'Çalışan Kodu (3 haneli)': 'Employee Code (3 digits)',
              'Çalışan Ekle': 'Add Employee',
              'Sil': 'Delete',
              'Giriş Yap': 'Login',
              'Geçersiz yönetici kodu!': 'Invalid admin code!',
              'Yönetici paneline giriş yapıldı!': 'Logged into admin panel!',
              'Satış başarıyla kaydedildi!': 'Sale successfully saved!',
              'Gider başarıyla kaydedildi!': 'Expense successfully saved!',
              'Ödeme başarıyla alındı!': 'Payment successfully received!',
              'Satış güncellendi!': 'Sale updated!',
              'Gider güncellendi!': 'Expense updated!',
              'Satış silindi!': 'Sale deleted!',
              'Gider silindi!': 'Expense deleted!',
              'Tüm veriler temizlendi!': 'All data cleared!',
              'Bu kod zaten kullanılıyor!': 'This code is already in use!',
              'Yeni çalışan eklendi!': 'New employee added!',
              'Çalışan silindi!': 'Employee deleted!',
              'Geçersiz çalışan kodu!': 'Invalid employee code!',
              'Geçersiz ödeme tutarı!': 'Invalid payment amount!',
              'Önce rapor oluşturun!': 'Generate report first!',
              'Önce bir dosya seçin!': 'Select a file first!',
              'Dosya seçildi ve yüklendi': 'File selected and loaded',
              'Veriler dosyadan yüklendi!': 'Data loaded from file!',
              'Veriler kaydedildi': 'Data saved',
              'Yeni dosya oluşturuldu': 'New file created',
              'Otomatik kaydetme hatası': 'Auto-save failed',
              'Kaydetme hatası': 'Save error',
              'File System API desteklenmiyor': 'File System API not supported',
              'File System API hazır': 'File System API ready',
              'Önceki dosyayı tekrar seçin': 'Please select the previous file again',
              'Dosya seçme hatası: ': 'File selection error: ',
              'Dosya okuma hatası: ': 'File read error: ',
              'Dosya oluşturma hatası: ': 'File creation error: ',
              'Yönetici kodu güncellendi!': 'Admin code updated!',
              'Yönetici kodu 3 haneli olmalıdır!': 'Admin code must be 3 digits!',
              'Uygulama ayarlarını ve kişiselleştirmeleri yönetin': 'Manage application settings and customizations',
              'Tema Ayarları': 'Theme Settings',
              'Uygulamanın görünümünü değiştirin': 'Change the application\'s appearance',
              'Tema Seçimi': 'Theme Selection',
              'Varsayılan (Açık)': 'Default (Light)',
              'Varsayılan (Koyu)': 'Default (Dark)',
              'Modern (Açık)': 'Modern (Light)',
              'Modern (Koyu)': 'Modern (Dark)',
              'Minimal (Açık)': 'Minimal (Light)',
              'Minimal (Koyu)': 'Minimal (Dark)',
              'Uygulama Ayarları': 'Application Settings',
              'Genel uygulama davranışlarını yapılandırın': 'Configure general application behaviors',
              'Yönetici Kodu': 'Admin Code',
              'Yeni yönetici kodu': 'New admin code',
              'Kodu Güncelle': 'Update Code',
              'Yönetici paneline erişim için kullanılan kod.': 'Code used to access the admin panel.',
              'Varsayılan Para Birimi': 'Default Currency',
              'Uygulamada kullanılan varsayılan para birimi sembolü.': 'Default currency symbol used in the application.',
              'Dil': 'Language',
              'Uygulama arayüzünün dili.': 'Language of the application interface.',
              'Çalışan Yönetimi': 'Employee Management',
              'Çalışan kodlarını ekleyin veya düzenleyin.': 'Add or edit employee codes.',
              'Türk Lirası (₺)': 'Turkish Lira (₺)',
              'Dolar ($)': 'Dollar ($)',
              'Euro (€)': 'Euro (€)',
              'Türkçe': 'Turkish',
              'English': 'English',
              'Ara...': 'Search...',
              'Bugün': 'Today',
              'Bu Hafta': 'This Week',
              'Bu Ay': 'This Month',
              'Bugünkü Gelir': 'Today\'s Income',
              'Bugünkü Gider': 'Today\'s Expense',
              'Net Kar': 'Net Profit',
              'Toplam Borç': 'Total Debt',
              'Tüm Zamanlar': 'All Time',
              'Son İşlemler': 'Recent Transactions',
              'En son gerçekleştirilen işlemler': 'Most recent transactions',
              'Tarih': 'Date',
              'Tür': 'Type',
              'Açıklama': 'Description',
              'Tutar': 'Amount',
              'Ödeme': 'Payment',
              'Çalışan': 'Employee',
              'Müşteri Adı': 'Customer Name',
              'Müşteri Soyadı': 'Customer Surname',
              'Telefon Numarası': 'Phone Number',
              'Halı m²': 'Carpet m²',
              'Satış Fiyatı': 'Sale Price',
              'Ödeme Türü': 'Payment Type',
              'Nakit': 'Cash',
              'Kart': 'Card',
              'Borç': 'Debt',
              'Ödenen Tutar': 'Paid Amount',
              'Ödenen Kısmın Türü': 'Type of Paid Amount',
              'Satış Kaydet': 'Save Sale',
              'Gider Açıklaması': 'Expense Description',
              'Gider Tutarı': 'Expense Amount',
              'Kategori': 'Category',
              'Kategori Seçin': 'Select Category',
              'Kira': 'Rent',
              'Elektrik': 'Electricity',
              'Su': 'Water',
              'Telefon': 'Phone',
              'Malzeme': 'Materials',
              'Personel': 'Personnel',
              'Diğer': 'Other',
              'Gider Kaydet': 'Save Expense',
              'Müşteri ara...': 'Search customer...',
              'Rapor Türü': 'Report Type',
              'Günlük': 'Daily',
              'Aylık': 'Monthly',
              'Yıllık': 'Yearly',
              'Rapor Oluştur': 'Generate Report',
              'Rapor İndir': 'Download Report',
              'Veri Dosyası Seç': 'Select Data File',
              'Bilgisayarınızdan bir JSON veri dosyası seçin': 'Select a JSON data file from your computer',
              'Verileri Kaydet': 'Save Data',
              'Mevcut verileri seçili dosyaya kaydeder': 'Saves current data to the selected file',
              'Yeni Dosya Oluştur': 'Create New File',
              'Yeni bir veri dosyası oluşturur': 'Creates a new data file',
              'Tüm Verileri Temizle': 'Clear All Data',
              'Bu işlem geri alınamaz!': '⚠️ This action is irreversible!',
              'Dosya Bilgileri': 'File Information',
              'Seçili Dosya:': 'Selected File:',
              'Son Güncelleme:': 'Last Update:',
              'Genel Bakış': 'Overview',
              'Satış Yönetimi': 'Sales Management',
              'Gider Yönetimi': 'Expense Management',
              'Analitik': 'Analytics',
              'Ana Sayfaya Dön': 'Back to Main Page',
              'Günlük Satış': 'Daily Sales',
              'Günlük Gider': 'Daily Expenses',
              'Günlük Kar': 'Daily Profit',
              'İşlem Sayısı': 'Number of Transactions',
              'Satış İşlemleri': 'Sales Transactions',
              'Müşteri': 'Customer',
              'Fiyat': 'Price',
              'İşlemler': 'Actions',
              'Gider İşlemleri': 'Expense Transactions',
              'Analitik ve İstatistikler': 'Analytics and Statistics',
              'Ortalama Satış': 'Average Sale',
              'En Aktif Çalışan': 'Most Active Employee',
              'Aylık Büyüme': 'Monthly Growth',
              'Toplam Müşteri': 'Total Customers',
              'Yönetici Girişi': 'Admin Login',
              'Kodu girin': 'Enter code',
              'Satış Düzenle': 'Edit Sale',
              'Güncelle': 'Update',
              'Gider Düzenle': 'Edit Expense',
              'Açıklama': 'Description',
              'Bekleyen Ödemeler': 'Pending Payments',
              'Ödeme Al': 'Receive Payment',
              'Toplam Borç': 'Total Debt',
              'Ödeme Tutarı': 'Payment Amount',
              'Ödeme Türü': 'Payment Type',
              'Kalan': 'Remaining',
              'Toplam': 'Total',
              'Ödenen': 'Paid',
              'Alışveriş Geçmişi': 'Purchase History',
              'Ödeme Geçmişi': 'Payment History',
              'Telefon:': 'Phone:',
              'Toplam Alışveriş:': 'Total Purchases:',
              'Son Alışveriş:': 'Last Purchase:',
              'Kalan Borç:': 'Remaining Debt:',
              'm²': 'm²',
              'Ödenen': 'Paid',
              'Satış': 'Sale',
              'Ödeme': 'Payment',
              'Gider': 'Expense',
              'Günlük Rapor': 'Daily Report',
              'Aylık Rapor': 'Monthly Report',
              'Yıllık Rapor': 'Yearly Report',
              'Toplam Gelir': 'Total Income',
              'Kar': 'Profit',
              'Borç': 'Debt',
              'İşlem Detayları': 'Transaction Details',
              'Bekleyen Borçlar': 'Pending Debts',
              'Müşteri Adı (F1 ile seç)': 'Customer Name (F1 to select)',
              'Çalışan Kodu': 'Employee Code',
              'Halı m²': 'Carpet m²',
              'Satış Fiyatı': 'Sale Price',
              'Ödenen Tutar': 'Paid Amount',
              'Gider Açıklaması': 'Expense Description',
              'Gider Tutarı': 'Expense Amount',
              'Müşteri ara...': 'Search customer...',
              'Tarih': 'Date',
              'Müşteri': 'Customer',
              'Tutar': 'Amount',
              'Ödeme': 'Payment',
              'Çalışan': 'Employee',
              'Açıklama': 'Description',
              'Kategori': 'Category',
              'Telefon': 'Phone',
              'Fiyat': 'Price',
              'Ödenen': 'Paid',
              'Toplam': 'Total',
              'Kalan': 'Remaining',
              'Ödeme Tutarı': 'Payment Amount',
              'Ödeme Türü': 'Payment Type',
              'Çalışan Kodu': 'Employee Code',
              'Bu çalışanı silmek istediğinizden emin misiniz?': 'Are you sure you want to delete this employee?',
              'Bu satışı silmek istediğinizden emin misiniz?': 'Are you sure you want to delete this sale?',
              'Bu gideri silmek istediğinizden emin misiniz?': 'Are you sure you want to delete this expense?',
              'Tüm verileri silmek istediğinizden emin misiniz? Bu işlem geri alınamaz!': 'Are you sure you want to clear all data? This action is irreversible!'
          }
      };

      function setLanguage(lang) {
          currentLanguage = lang;
          localStorage.setItem('theLengLanguage', lang);
          document.getElementById('languageSelect').value = lang;

          // Update static texts
          document.querySelectorAll('[data-lang-key]').forEach(element => {
              const key = element.getAttribute('data-lang-key');
              if (translations[lang] && translations[lang][key]) {
                  element.textContent = translations[lang][key];
              }
          });

          // Update specific elements that are not data-lang-key
          document.title = translations[lang]['THE LENG - Yönetici Paneli'] || 'THE LENG - Admin Panel';
          document.querySelector('.sidebar-title').textContent = 'THE LENG'; // Always THE LENG
          document.querySelector('meta[name="description"]').setAttribute('content', translations[lang]['THE LENG Yönetici Paneli - Satış, Gider ve Müşteri Yönetimi'] || 'THE LENG Admin Panel - Sales, Expense, and Customer Management');
          document.querySelector('meta[name="apple-mobile-web-app-title"]').setAttribute('content', 'THE LENG');

          // Update placeholders
          document.querySelector('.search-input').setAttribute('placeholder', translations[lang]['Ara...']);
          document.getElementById('customerName').nextElementSibling.querySelector('small').textContent = `(${translations[lang]['F1 ile seç']})`;
          document.getElementById('customerSearch').setAttribute('placeholder', translations[lang]['Müşteri ara...']);
          document.getElementById('adminCode').setAttribute('placeholder', translations[lang]['Kodu girin']);
          document.getElementById('adminCodeSetting').setAttribute('placeholder', translations[lang]['Yeni yönetici kodu']);
          document.getElementById('adminCodeSetting').nextElementSibling.nextElementSibling.textContent = translations[lang]['Yönetici paneline erişim için kullanılan kod.'];
          document.getElementById('currencySelect').nextElementSibling.textContent = translations[lang]['Uygulamada kullanılan varsayılan para birimi sembolü.'];
          document.getElementById('languageSelect').nextElementSibling.textContent = translations[lang]['Uygulama arayüzünün dili.'];
          document.querySelector('#data-page .form-group:nth-child(1) p').textContent = translations[lang]['Bilgisayarınızdan bir JSON veri dosyası seçin'];
          document.querySelector('#data-page .form-group:nth-child(2) p').textContent = translations[lang]['Mevcut verileri seçili dosyaya kaydeder'];
          document.querySelector('#data-page .form-group:nth-child(3) p').textContent = translations[lang]['Yeni bir veri dosyası oluşturur'];
          document.querySelector('#data-page .form-group:nth-child(4) p').textContent = translations[lang]['⚠️ Bu işlem geri alınamaz!'];

          // Update button texts
          document.querySelector('#salesForm button[type="submit"]').innerHTML = `<i class="fas fa-check"></i> ${translations[lang]['Satış Kaydet']}`;
          document.querySelector('#expensesForm button[type="submit"]').innerHTML = `<i class="fas fa-check"></i> ${translations[lang]['Gider Kaydet']}`;
          document.querySelector('#reports-page .d-flex button:nth-child(1)').innerHTML = `<i class="fas fa-chart-bar"></i> ${translations[lang]['Rapor Oluştur']}`;
          document.querySelector('#reports-page .d-flex button:nth-child(2)').innerHTML = `<i class="fas fa-download"></i> ${translations[lang]['Rapor İndir']}`;
          document.querySelector('#data-page .form-group:nth-child(1) button').innerHTML = `<i class="fas fa-folder-open"></i> ${translations[lang]['Veri Dosyası Seç']}`;
          document.querySelector('#data-page .form-group:nth-child(2) button').innerHTML = `<i class="fas fa-save"></i> ${translations[lang]['Verileri Kaydet']}`;
          document.querySelector('#data-page .form-group:nth-child(3) button').innerHTML = `<i class="fas fa-file-plus"></i> ${translations[lang]['Yeni Dosya Oluştur']}`;
          document.querySelector('#data-page .form-group:nth-child(4) button').innerHTML = `<i class="fas fa-trash"></i> ${translations[lang]['Tüm Verileri Temizle']}`;
          document.querySelector('#adminLoginModal button').innerHTML = `<i class="fas fa-sign-in-alt"></i> ${translations[lang]['Giriş Yap']}`;
          document.querySelector('#addEmployeeModal button[type="submit"]').innerHTML = `<i class="fas fa-user-plus"></i> ${translations[lang]['Çalışan Ekle']}`;
          document.querySelector('#editSaleModal button[type="submit"]').innerHTML = `<i class="fas fa-check"></i> ${translations[lang]['Güncelle']}`;
          document.querySelector('#editExpenseModal button[type="submit"]').innerHTML = `<i class="fas fa-check"></i> ${translations[lang]['Güncelle']}`;
          document.querySelector('#paymentModal button').innerHTML = `<i class="fas fa-check"></i> ${translations[lang]['Ödeme Al']}`;
          document.querySelector('#settings-page .card:nth-child(3) .card-header button').innerHTML = `<i class="fas fa-user-plus"></i> ${translations[lang]['Yeni Çalışan Ekle']}`;
          document.querySelector('#settings-page #adminCodeSetting').nextElementSibling.innerHTML = `<i class="fas fa-save"></i> ${translations[lang]['Kodu Güncelle']}`;


          // Update select options
          document.querySelectorAll('#expenseCategory option').forEach(option => {
              if (option.value !== "") option.textContent = translations[lang][option.value.charAt(0).toUpperCase() + option.value.slice(1)] || option.textContent;
          });
          document.querySelectorAll('#editExpenseCategory option').forEach(option => {
              option.textContent = translations[lang][option.value.charAt(0).toUpperCase() + option.value.slice(1)] || option.textContent;
          });
          document.querySelectorAll('#reportType option').forEach(option => {
              option.textContent = translations[lang][option.value.charAt(0).toUpperCase() + option.value.slice(1)] || option.textContent;
          });
          document.querySelectorAll('#currencySelect option').forEach(option => {
              option.textContent = translations[lang][option.textContent.split('(')[0].trim()] + ` (${option.value})`;
          });
          document.querySelectorAll('#languageSelect option').forEach(option => {
              option.textContent = translations[lang][option.textContent] || option.textContent;
          });
          document.querySelectorAll('#themeSelect option').forEach(option => {
              const originalText = option.textContent;
              const parts = originalText.split('(');
              if (parts.length > 1) {
                  const themeName = parts[0].trim();
                  const themeType = parts[1].replace(')', '').trim();
                  option.textContent = `${translations[lang][themeName]} (${translations[lang][themeType]})`;
              } else {
                  option.textContent = translations[lang][originalText] || originalText;
              }
          });

          // Re-render dynamic content that uses text
          updateDashboard();
          loadCustomers();
          if (isAdminLoggedIn) {
              loadAdminData();
              loadEmployees();
          }
          generateReport(); // Re-generate report to update texts
      }

      // Update debt badge
      function updateDebtBadge() {
          const debtCount = debtsData.length;
          const badge = document.getElementById('debtBadge');
          if (debtCount > 0) {
              badge.textContent = debtCount;
              badge.style.display = 'flex';
          } else {
              badge.style.display = 'none';
          }
      }

      // Admin functions
      function showAdminLogin() {
          document.getElementById('adminLoginModal').style.display = 'block';
      }

      function closeAdminLogin() {
          document.getElementById('adminLoginModal').style.display = 'none';
          document.getElementById('adminCode').value = '';
      }

      function verifyAdmin() {
          const code = document.getElementById('adminCode').value;
          if (code === ADMIN_CODE) {
              isAdminLoggedIn = true;
              document.getElementById('mainApp').style.display = 'none';
              document.getElementById('adminPage').classList.add('active');
              closeAdminLogin();
              loadAdminData();
              loadEmployees();
              showAlert(translations[currentLanguage]['Yönetici paneline giriş yapıldı!'], 'success');
          } else {
              showAlert(translations[currentLanguage]['Geçersiz yönetici kodu!'], 'error');
          }
      }

      function goBackToMain() {
          document.getElementById('adminPage').classList.remove('active');
          document.getElementById('mainApp').style.display = 'block';
          updateDashboard();
      }

      function showAdminSection(sectionName) {
          // Update navigation
          document.querySelectorAll('.admin-nav-btn').forEach(btn => {
              btn.classList.remove('active');
          });
          event.target.classList.add('active');

          // Show content
          document.querySelectorAll('.admin-content').forEach(content => {
              content.classList.remove('active');
          });
          
          const targetSection = document.getElementById('admin' + sectionName.charAt(0).toUpperCase() + sectionName.slice(1));
          if (targetSection) {
              targetSection.classList.add('active');
          }

          // Load specific data
          if (sectionName === 'sales') {
              loadAdminSales();
          } else if (sectionName === 'expenses') {
              loadAdminExpenses();
          } else if (sectionName === 'employees') {
              loadEmployees('employeeGrid');
          } else if (sectionName === 'analytics') {
              loadAnalytics();
          } else if (sectionName === 'overview') {
              filterAdminData();
          }
      }

      function loadAdminData() {
          filterAdminData();
          loadAdminSales();
          loadAdminExpenses();
          loadAnalytics();
      }

      function filterAdminData() {
          const selectedDate = document.getElementById('adminDateFilter').value;
          const targetDate = new Date(selectedDate);
          
          const filteredSales = salesData.filter(sale => {
              const saleDate = new Date(sale.date);
              return saleDate.toDateString() === targetDate.toDateString();
          });
          
          const filteredExpenses = expensesData.filter(expense => {
              const expenseDate = new Date(expense.date);
              return expenseDate.toDateString() === targetDate.toDateString();
          });
          
          const filteredPayments = paymentsData.filter(payment => {
              const paymentDate = new Date(payment.date);
              return paymentDate.toDateString() === targetDate.toDateString();
          });

          const totalSales = filteredSales.reduce((sum, sale) => sum + sale.paidAmount, 0);
          const totalPayments = filteredPayments.reduce((sum, payment) => sum + payment.amount, 0);
          const totalIncome = totalSales + totalPayments;
          const totalExpenses = filteredExpenses.reduce((sum, expense) => sum + expense.amount, 0);
          const netProfit = totalIncome - totalExpenses;
          const totalTransactions = filteredSales.length + filteredExpenses.length + filteredPayments.length;

          document.getElementById('adminTotalSales').textContent = totalIncome.toLocaleString('tr-TR') + ' ' + currentCurrencySymbol;
          document.getElementById('adminTotalExpenses').textContent = totalExpenses.toLocaleString('tr-TR') + ' ' + currentCurrencySymbol;
          document.getElementById('adminNetProfit').textContent = netProfit.toLocaleString('tr-TR') + ' ' + currentCurrencySymbol;
          document.getElementById('adminTotalTransactions').textContent = totalTransactions;
      }

      function loadAdminSales() {
          const selectedDate = document.getElementById('salesDateFilter').value;
          const targetDate = new Date(selectedDate);
          
          const filteredSales = salesData.filter(sale => {
              const saleDate = new Date(sale.date);
              return saleDate.toDateString() === targetDate.toDateString();
          });

          const tbody = document.getElementById('adminSalesTable');
          tbody.innerHTML = filteredSales.map(sale => `
              <tr>
                  <td>${new Date(sale.date).toLocaleDateString('tr-TR')}</td>
                  <td>${sale.customerName} ${sale.customerSurname}</td>
                  <td>${sale.salePrice.toLocaleString('tr-TR')} ${currentCurrencySymbol}</td>
                  <td>
                      <span class="status-badge status-active">
                          ${getPaymentTypeDisplay(sale.paidPaymentType)}
                      </span>
                  </td>
                  <td>${sale.employee}</td>
                  <td>
                      <div style="display: flex; gap: 8px;">
                          <button class="btn btn-warning btn-small ripple-warning" onclick="editSale(${sale.id})">
                              <i class="fas fa-edit"></i>
                          </button>
                          <button class="btn btn-danger btn-small ripple-danger" onclick="deleteSale(${sale.id})">
                              <i class="fas fa-trash"></i>
                          </button>
                      </div>
                  </td>
              </tr>
          `).join('');
      }

      function loadAdminExpenses() {
          const selectedDate = document.getElementById('expensesDateFilter').value;
          const targetDate = new Date(selectedDate);
          
          const filteredExpenses = expensesData.filter(expense => {
              const expenseDate = new Date(expense.date);
              return expenseDate.toDateString() === targetDate.toDateString();
          });

          const tbody = document.getElementById('adminExpensesTable');
          tbody.innerHTML = filteredExpenses.map(expense => `
              <tr>
                  <td>${new Date(expense.date).toLocaleDateString('tr-TR')}</td>
                  <td>${expense.description}</td>
                  <td>${expense.category}</td>
                  <td>${expense.amount.toLocaleString('tr-TR')} ${currentCurrencySymbol}</td>
                  <td>${expense.employee}</td>
                  <td>
                      <div style="display: flex; gap: 8px;">
                          <button class="btn btn-warning btn-small ripple-warning" onclick="editExpense(${expense.id})">
                              <i class="fas fa-edit"></i>
                          </button>
                          <button class="btn btn-danger btn-small ripple-danger" onclick="deleteExpense(${expense.id})">
                              <i class="fas fa-trash"></i>
                          </button>
                      </div>
                  </td>
              </tr>
          `).join('');
      }

      // Employee Management
      function loadEmployees(targetElementId = 'employeeGrid') {
          const employeeGrid = document.getElementById(targetElementId);
          employeeGrid.innerHTML = Object.entries(employees).map(([code, name]) => `
              <div class="employee-card ripple">
                  <div class="employee-name">${name}</div>
                  <div class="employee-code">${code}</div>
                  <button class="btn btn-danger btn-small ripple-danger mt-2" onclick="removeEmployee('${code}')">
                      <i class="fas fa-trash"></i>
                      ${translations[currentLanguage]['Sil']}
                  </button>
              </div>
          `).join('');
      }

      function showAddEmployeeModal() {
          document.getElementById('addEmployeeModal').style.display = 'block';
      }

      function closeAddEmployeeModal() {
          document.getElementById('addEmployeeModal').style.display = 'none';
          document.getElementById('addEmployeeForm').reset();
      }

      document.getElementById('addEmployeeForm').addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const name = document.getElementById('employeeName').value;
          const code = document.getElementById('employeeCodeNew').value;
          
          if (employees[code]) {
              showAlert(translations[currentLanguage]['Bu kod zaten kullanılıyor!'], 'error');
              return;
          }
          
          employees[code] = name;
          await autoSave();
          loadEmployees('employeeGrid'); // Update admin employee list
          loadEmployees('settingsEmployeeGrid'); // Update settings employee list
          closeAddEmployeeModal();
          showAlert(translations[currentLanguage]['Yeni çalışan eklendi!'], 'success');
      });

      async function removeEmployee(code) {
          if (confirm(translations[currentLanguage]['Bu çalışanı silmek istediğinizden emin misiniz?'])) {
              delete employees[code];
              await autoSave();
              loadEmployees('employeeGrid'); // Update admin employee list
              loadEmployees('settingsEmployeeGrid'); // Update settings employee list
              showAlert(translations[currentLanguage]['Çalışan silindi!'], 'success');
          }
      }

      function loadAnalytics() {
          // Calculate average sale
          const avgSale = salesData.length > 0 ? 
              salesData.reduce((sum, sale) => sum + sale.salePrice, 0) / salesData.length : 0;
          
          // Find top employee
          const employeeStats = {};
          salesData.forEach(sale => {
              employeeStats[sale.employee] = (employeeStats[sale.employee] || 0) + 1;
          });
          const topEmployee = Object.keys(employeeStats).reduce((a, b) => 
              employeeStats[a] > employeeStats[b] ? a : b, '-');
          
          // Calculate monthly growth (simplified)
          const thisMonth = new Date().getMonth();
          const thisYear = new Date().getFullYear();
          const thisMonthSales = salesData.filter(sale => {
              const saleDate = new Date(sale.date);
              return saleDate.getMonth() === thisMonth && saleDate.getFullYear() === thisYear;
          });
          const lastMonthSales = salesData.filter(sale => {
              const saleDate = new Date(sale.date);
              return saleDate.getMonth() === (thisMonth - 1) && saleDate.getFullYear() === thisYear;
          });
          
          const thisMonthTotal = thisMonthSales.reduce((sum, sale) => sum + sale.salePrice, 0);
          const lastMonthTotal = lastMonthSales.reduce((sum, sale) => sum + sale.salePrice, 0);
          const growth = lastMonthTotal > 0 ? ((thisMonthTotal - lastMonthTotal) / lastMonthTotal * 100) : 0;
          
          document.getElementById('analyticsAvgSale').textContent = avgSale.toLocaleString('tr-TR') + ' ' + currentCurrencySymbol;
          document.getElementById('analyticsTopEmployee').textContent = topEmployee;
          document.getElementById('analyticsMonthlyGrowth').textContent = growth.toFixed(1) + '%';
          document.getElementById('analyticsCustomerCount').textContent = customersData.length;
      }

      // Dashboard period management
      function getDateRange(period, customDate = null) {
          const now = new Date();
          let startDate, endDate;
          
          switch (period) {
              case 'today':
                  startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                  endDate = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);
                  break;
              case 'yesterday':
                  startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 1);
                  endDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                  break;
              case 'week':
                  const weekStart = now.getDate() - now.getDay();
                  startDate = new Date(now.getFullYear(), now.getMonth(), weekStart);
                  endDate = new Date(now.getFullYear(), now.getMonth(), weekStart + 7);
                  break;
              case 'month':
                  startDate = new Date(now.getFullYear(), now.getMonth(), 1);
                  endDate = new Date(now.getFullYear(), now.getMonth() + 1, 1);
                  break;
              case 'custom':
                  if (customDate) {
                      const custom = new Date(customDate);
                      startDate = new Date(custom.getFullYear(), custom.getMonth(), custom.getDate());
                      endDate = new Date(custom.getFullYear(), custom.getMonth(), custom.getDate() + 1);
                  } else {
                      return getDateRange('today');
                  }
                  break;
              default:
                  return getDateRange('today');
          }
          
          return { startDate, endDate };
      }

      // Customer autocomplete functionality
      function setupCustomerAutocomplete() {
          const customerNameInput = document.getElementById('customerName');
          const suggestionsDiv = document.getElementById('customerSuggestions');
          
          customerNameInput.addEventListener('input', function() {
              const query = this.value.toLowerCase();
              if (query.length < 2) {
                  hideSuggestions();
                  return;
              }
              
              customerSuggestions = customersData.filter(customer => 
                  customer.name.toLowerCase().includes(query) ||
                  customer.surname.toLowerCase().includes(query) ||
                  customer.phone.includes(query)
              ).slice(0, 5);
              
              showSuggestions();
          });
          
          customerNameInput.addEventListener('keydown', function(e) {
              if (e.key === 'F1') {
                  e.preventDefault();
                  if (customersData.length > 0) {
                      customerSuggestions = customersData.slice(0, 10);
                      showSuggestions();
                  }
              } else if (e.key === 'ArrowDown') {
                  e.preventDefault();
                  if (isShowingSuggestions) {
                      selectedCustomerIndex = Math.min(selectedCustomerIndex + 1, customerSuggestions.length - 1);
                      updateSuggestionSelection();
                  }
              } else if (e.key === 'ArrowUp') {
                  e.preventDefault();
                  if (isShowingSuggestions) {
                      selectedCustomerIndex = Math.max(selectedCustomerIndex - 1, -1);
                      updateSuggestionSelection();
                  }
              } else if (e.key === 'Enter') {
                  if (isShowingSuggestions && selectedCustomerIndex >= 0) {
                      e.preventDefault();
                      selectCustomer(customerSuggestions[selectedCustomerIndex]);
                  }
              } else if (e.key === 'Escape') {
                  hideSuggestions();
              }
          });
          
          // Hide suggestions when clicking outside
          document.addEventListener('click', function(e) {
              if (!customerNameInput.contains(e.target) && !suggestionsDiv.contains(e.target)) {
                  hideSuggestions();
              }
          });
      }

      function showSuggestions() {
          const suggestionsDiv = document.getElementById('customerSuggestions');
          suggestionsDiv.innerHTML = customerSuggestions.map((customer, index) => `
              <div class="customer-suggestion ripple ${index === selectedCustomerIndex ? 'selected' : ''}" 
                   onclick="selectCustomer(${JSON.stringify(customer).replace(/"/g, '&quot;')})">
                  <strong>${customer.name} ${customer.surname}</strong><br>
                  <small>${customer.phone} - ${customer.totalPurchases.toLocaleString('tr-TR')} ${currentCurrencySymbol}</small>
              </div>
          `).join('');
          
          suggestionsDiv.style.display = 'block';
          isShowingSuggestions = true;
          selectedCustomerIndex = -1;
      }

      function hideSuggestions() {
          document.getElementById('customerSuggestions').style.display = 'none';
          isShowingSuggestions = false;
          selectedCustomerIndex = -1;
      }

      function updateSuggestionSelection() {
          const suggestions = document.querySelectorAll('.customer-suggestion');
          suggestions.forEach((suggestion, index) => {
              suggestion.classList.toggle('selected', index === selectedCustomerIndex);
          });
      }

      function selectCustomer(customer) {
          document.getElementById('customerName').value = customer.name;
          document.getElementById('customerSurname').value = customer.surname;
          document.getElementById('customerPhone').value = customer.phone;
          hideSuggestions();
      }

      // Payment type selection
      function selectPaymentType(type) {
          selectedPaymentType = type;
          document.querySelectorAll('#sales-page .payment-option').forEach(option => {
              option.classList.remove('selected');
          });
          event.target.closest('.payment-option').classList.add('selected');

          const debtOptions = document.getElementById('debtOptions');
          if (type === 'debt') {
              debtOptions.style.display = 'block';
          } else {
              debtOptions.style.display = 'none';
          }
      }

      function selectPaidPaymentType(type) {
          selectedPaidPaymentType = type;
          document.querySelectorAll('#paidPaymentTypeGroup .payment-option').forEach(option => {
              option.classList.remove('selected');
          });
          event.target.closest('.payment-option').classList.add('selected');
      }

      function selectDebtPaymentType(type) {
          selectedDebtPaymentType = type;
          document.querySelectorAll('#paymentModal .payment-option').forEach(option => {
              option.classList.remove('selected');
          });
          event.target.closest('.payment-option').classList.add('selected');
      }

      // Employee verification
      function verifyEmployeeCode(code) {
          return employees[code] || null;
      }

      // Get payment type display
      function getPaymentTypeDisplay(type) {
          switch(type) {
              case 'cash': return translations[currentLanguage]['Nakit'];
              case 'card': return translations[currentLanguage]['Kart'];
              case 'debt': return translations[currentLanguage]['Borç'];
              default: return type;
          }
      }

      // Sales form submission
      document.getElementById('salesForm').addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const employeeCode = document.getElementById('employeeCode').value;
          const employeeName = verifyEmployeeCode(employeeCode);
          
          if (!employeeName) {
              showAlert(translations[currentLanguage]['Geçersiz çalışan kodu!'], 'error');
              return;
          }

          const customerName = document.getElementById('customerName').value;
          const customerSurname = document.getElementById('customerSurname').value;
          const customerPhone = document.getElementById('customerPhone').value;
          const salePrice = parseFloat(document.getElementById('salePrice').value);
          const paidAmount = selectedPaymentType === 'debt' ? parseFloat(document.getElementById('paidAmount').value) || 0 : salePrice;

          const saleData = {
              id: Date.now(),
              date: new Date().toISOString(),
              customerName: customerName,
              customerSurname: customerSurname,
              customerPhone: customerPhone,
              carpetArea: parseFloat(document.getElementById('carpetArea').value),
              salePrice: salePrice,
              paymentType: selectedPaymentType,
              paidAmount: paidAmount,
              paidPaymentType: selectedPaymentType === 'debt' ? selectedPaidPaymentType : selectedPaymentType,
              employee: employeeName,
              employeeCode: employeeCode
          };

          salesData.push(saleData);
          updateCustomer(customerName, customerSurname, customerPhone, saleData);

          if (selectedPaymentType === 'debt' && paidAmount < salePrice) {
              const debtAmount = salePrice - paidAmount;
              const debtData = {
                  id: Date.now(),
                  saleId: saleData.id,
                  customerName: customerName,
                  customerSurname: customerSurname,
                  customerPhone: customerPhone,
                  totalAmount: salePrice,
                  paidAmount: paidAmount,
                  remainingAmount: debtAmount,
                  date: new Date().toISOString(),
                  employee: employeeName
              };
              debtsData.push(debtData);
          }
          
          await autoSave();
          showAlert(translations[currentLanguage]['Satış başarıyla kaydedildi!'], 'success');
          document.getElementById('salesForm').reset();
          selectPaymentType('cash');
          selectPaidPaymentType('cash');
          updateDashboard();
          updateDebtBadge();
          if (isAdminLoggedIn) loadAdminData();
      });

      // Update customer data
      function updateCustomer(name, surname, phone, saleData) {
          const existingCustomerIndex = customersData.findIndex(customer => 
              customer.phone === phone
          );

          if (existingCustomerIndex !== -1) {
              customersData[existingCustomerIndex].sales.push(saleData);
              customersData[existingCustomerIndex].totalPurchases += saleData.salePrice;
              customersData[existingCustomerIndex].lastPurchase = saleData.date;
          } else {
              const newCustomer = {
                  id: Date.now(),
                  name: name,
                  surname: surname,
                  phone: phone,
                  totalPurchases: saleData.salePrice,
                  lastPurchase: saleData.date,
                  sales: [saleData]
              };
              customersData.push(newCustomer);
          }
      }

      // Expenses form submission
      document.getElementById('expensesForm').addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const employeeCode = document.getElementById('expenseEmployeeCode').value;
          const employeeName = verifyEmployeeCode(employeeCode);
          
          if (!employeeName) {
              showAlert(translations[currentLanguage]['Geçersiz çalışan kodu!'], 'error');
              return;
          }

          const expenseData = {
              id: Date.now(),
              date: new Date().toISOString(),
              description: document.getElementById('expenseDescription').value,
              amount: parseFloat(document.getElementById('expenseAmount').value),
              category: document.getElementById('expenseCategory').value,
              employee: employeeName,
              employeeCode: employeeCode
          };

          expensesData.push(expenseData);
          
          await autoSave();
          showAlert(translations[currentLanguage]['Gider başarıyla kaydedildi!'], 'success');
          document.getElementById('expensesForm').reset();
          updateDashboard();
          if (isAdminLoggedIn) loadAdminData();
      });

      // Update dashboard
      function updateDashboard() {
          const { startDate, endDate } = getDateRange(currentDashboardPeriod);
          
          // Filter data by selected period (except debt which is always total)
          const filteredSales = salesData.filter(sale => {
              const saleDate = new Date(sale.date);
              return saleDate >= startDate && saleDate < endDate;
          });
          
          const filteredExpenses = expensesData.filter(expense => {
              const expenseDate = new Date(expense.date);
              return expenseDate >= startDate && expenseDate < endDate;
          });
          
          const filteredPayments = paymentsData.filter(payment => {
              const paymentDate = new Date(payment.date);
              return paymentDate >= startDate && paymentDate < endDate;
          });

          const totalSales = filteredSales.reduce((sum, sale) => sum + sale.paidAmount, 0);
          const totalPayments = filteredPayments.reduce((sum, payment) => sum + payment.amount, 0);
          const totalIncome = totalSales + totalPayments;
          const totalExpenses = filteredExpenses.reduce((sum, expense) => sum + expense.amount, 0);
          const totalDebt = debtsData.reduce((sum, debt) => sum + debt.remainingAmount, 0); // Always total debt
          const netProfit = totalIncome - totalExpenses;

          document.getElementById('totalSales').textContent = totalIncome.toLocaleString('tr-TR') + ' ' + currentCurrencySymbol;
          document.getElementById('totalExpenses').textContent = totalExpenses.toLocaleString('tr-TR') + ' ' + currentCurrencySymbol;
          document.getElementById('netProfit').textContent = netProfit.toLocaleString('tr-TR') + ' ' + currentCurrencySymbol;
          document.getElementById('totalDebt').textContent = totalDebt.toLocaleString('tr-TR') + ' ' + currentCurrencySymbol;

          // Update profit change indicator
          const profitChangeEl = document.getElementById('profitChange');
          if (netProfit > 0) {
              profitChangeEl.className = 'stat-change positive';
              profitChangeEl.textContent = '+' + ((netProfit / (totalIncome || 1)) * 100).toFixed(1) + '%';
          } else if (netProfit < 0) {
              profitChangeEl.className = 'stat-change negative';
              profitChangeEl.textContent = ((netProfit / (totalIncome || 1)) * 100).toFixed(1) + '%';
          } else {
              profitChangeEl.className = 'stat-change';
              profitChangeEl.textContent = '0%';
          }

          updateRecentTransactions();
      }

      // Update recent transactions
      function updateRecentTransactions() {
          const allTransactions = [
              ...salesData.map(sale => ({
                  date: sale.date,
                  type: translations[currentLanguage]['Satış'],
                  description: `${sale.customerName} ${sale.customerSurname}`,
                  amount: sale.paidAmount,
                  paymentType: sale.paidPaymentType,
                  employee: sale.employee
              })),
              ...paymentsData.map(payment => ({
                  date: payment.date,
                  type: translations[currentLanguage]['Ödeme'],
                  description: `${payment.customerName} ${payment.customerSurname}`,
                  amount: payment.amount,
                  paymentType: payment.paymentType,
                  employee: payment.employee
              })),
              ...expensesData.map(expense => ({
                  date: expense.date,
                  type: translations[currentLanguage]['Gider'],
                  description: expense.description,
                  amount: -expense.amount,
                  paymentType: '-',
                  employee: expense.employee
              }))
          ].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 10);

          const tbody = document.getElementById('recentTransactions');
          tbody.innerHTML = allTransactions.map(transaction => `
              <tr>
                  <td>${new Date(transaction.date).toLocaleDateString('tr-TR')}</td>
                  <td>${transaction.type}</td>
                  <td>${transaction.description}</td>
                  <td style="color: ${transaction.amount >= 0 ? 'var(--success-color)' : 'var(--danger-color)'}">
                      ${transaction.amount >= 0 ? '+' : ''}${transaction.amount.toLocaleString('tr-TR')} ${currentCurrencySymbol}
                  </td>
                  <td>
                      ${transaction.paymentType !== '-' ? 
                          `<span class="status-badge status-active">
                              ${getPaymentTypeDisplay(transaction.paymentType)}
                          </span>` : 
                          '-'
                      }
                  </td>
                  <td>${transaction.employee}</td>
              </tr>
          `).join('');
      }

      // Load customers
      function loadCustomers() {
          const customersList = document.getElementById('customersList');
          customersList.innerHTML = customersData.map(customer => `
              <div class="customer-item ripple" onclick="showCustomerDetails('${customer.id}')">
                  <div class="customer-name">${customer.name} ${customer.surname}</div>
                  <div class="customer-info">
                      <i class="fas fa-phone"></i>
                      ${customer.phone}
                      <i class="fas fa-lira-sign"></i>
                      ${customer.totalPurchases.toLocaleString('tr-TR')} ${currentCurrencySymbol}
                      <i class="fas fa-calendar"></i>
                      ${new Date(customer.lastPurchase).toLocaleDateString('tr-TR')}
                  </div>
              </div>
          `).join('');
      }

      // Search customers
      function searchCustomers() {
          const searchTerm = document.getElementById('customerSearch').value.toLowerCase();
          const filteredCustomers = customersData.filter(customer => 
              customer.name.toLowerCase().includes(searchTerm) ||
              customer.surname.toLowerCase().includes(searchTerm) ||
              customer.phone.includes(searchTerm)
          );

          const customersList = document.getElementById('customersList');
          customersList.innerHTML = filteredCustomers.map(customer => `
              <div class="customer-item ripple" onclick="showCustomerDetails('${customer.id}')">
                  <div class="customer-name">${customer.name} ${customer.surname}</div>
                  <div class="customer-info">
                      <i class="fas fa-phone"></i>
                      ${customer.phone}
                      <i class="fas fa-lira-sign"></i>
                      ${customer.totalPurchases.toLocaleString('tr-TR')} ${currentCurrencySymbol}
                      <i class="fas fa-calendar"></i>
                      ${new Date(customer.lastPurchase).toLocaleDateString('tr-TR')}
                  </div>
              </div>
          `).join('');
      }

      // Show customer details
      function showCustomerDetails(customerId) {
          const customer = customersData.find(c => c.id == customerId);
          if (!customer) return;

          const customerDebt = debtsData.find(debt => debt.customerPhone === customer.phone);
          const customerPayments = paymentsData.filter(payment => payment.customerPhone === customer.phone);
          
          document.getElementById('customerDetails').innerHTML = `
              <h3 class="card-title mb-3">
                  <i class="fas fa-user"></i>
                  ${customer.name} ${customer.surname}
              </h3>
              <div class="card mb-3">
                  <div class="card-content">
                      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                          <div>
                              <strong>${translations[currentLanguage]['Telefon:']}</strong><br>
                              <span style="color: var(--info-color);">${customer.phone}</span>
                          </div>
                          <div>
                              <strong>${translations[currentLanguage]['Toplam Alışveriş:']}</strong><br>
                              <span style="color: var(--success-color); font-size: 18px; font-weight: 600;">${customer.totalPurchases.toLocaleString('tr-TR')} ${currentCurrencySymbol}</span>
                          </div>
                          <div>
                              <strong>${translations[currentLanguage]['Son Alışveriş:']}</strong><br>
                              <span style="color: var(--text-secondary);">${new Date(customer.lastPurchase).toLocaleDateString('tr-TR')}</span>
                          </div>
                          ${customerDebt ? `
                          <div>
                              <strong>${translations[currentLanguage]['Kalan Borç:']}</strong><br>
                              <span style="color: var(--danger-color); font-size: 18px; font-weight: 600;">${customerDebt.remainingAmount.toLocaleString('tr-TR')} ${currentCurrencySymbol}</span>
                          </div>
                          ` : ''}
                      </div>
                  </div>
              </div>
              
              <div class="card">
                  <div class="card-header">
                      <h4 class="card-title">${translations[currentLanguage]['Alışveriş Geçmişi']}</h4>
                  </div>
                  <div class="card-content" style="padding: 0;">
                      <div class="table-container">
                          <table class="table">
                              <thead>
                                  <tr>
                                      <th>${translations[currentLanguage]['Tarih']}</th>
                                      <th>${translations[currentLanguage]['m²']}</th>
                                      <th>${translations[currentLanguage]['Fiyat']}</th>
                                      <th>${translations[currentLanguage]['Ödeme']}</th>
                                      <th>${translations[currentLanguage]['Çalışan']}</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  ${customer.sales.map(sale => `
                                      <tr>
                                          <td>${new Date(sale.date).toLocaleDateString('tr-TR')}</td>
                                          <td>${sale.carpetArea}</td>
                                          <td>${sale.salePrice.toLocaleString('tr-TR')} ${currentCurrencySymbol}</td>
                                          <td>
                                              <span class="status-badge status-active">
                                                  ${getPaymentTypeDisplay(sale.paidPaymentType)}
                                              </span>
                                              ${sale.paymentType === 'debt' ? ` <span style="color: var(--danger-color);">(${translations[currentLanguage]['Borç']})</span>` : ''}
                                          </td>
                                          <td>${sale.employee}</td>
                                      </tr>
                                  `).join('')}
                              </tbody>
                          </table>
                      </div>
                  </div>
              </div>

              ${customerPayments.length > 0 ? `
                  <div class="card">
                      <div class="card-header">
                          <h4 class="card-title">${translations[currentLanguage]['Ödeme Geçmişi']}</h4>
                      </div>
                      <div class="card-content" style="padding: 0;">
                          <div class="table-container">
                              <table class="table">
                                  <thead>
                                      <tr>
                                          <th>${translations[currentLanguage]['Tarih']}</th>
                                          <th>${translations[currentLanguage]['Tutar']}</th>
                                          <th>${translations[currentLanguage]['Ödeme Türü']}</th>
                                          <th>${translations[currentLanguage]['Çalışan']}</th>
                                      </tr>
                                  </thead>
                                  <tbody>
                                      ${customerPayments.map(payment => `
                                          <tr>
                                              <td>${new Date(payment.date).toLocaleDateString('tr-TR')}</td>
                                              <td style="color: var(--success-color);">${payment.amount.toLocaleString('tr-TR')} ${currentCurrencySymbol}</td>
                                              <td>
                                                  <span class="status-badge status-active">
                                                      ${getPaymentTypeDisplay(payment.paymentType)}
                                                  </span>
                                              </td>
                                              <td>${payment.employee}</td>
                                          </tr>
                                      `).join('')}
                                  </tbody>
                              </table>
                          </div>
                      </div>
                  </div>
              ` : ''}
          `;
          
          document.getElementById('customerModal').style.display = 'block';
      }

      // Show pending payments
      function showPendingPayments() {
          const pendingPaymentsList = document.getElementById('pendingPaymentsList');
          pendingPaymentsList.innerHTML = debtsData.map(debt => `
              <div class="customer-item ripple" onclick="showPaymentModal('${debt.customerPhone}')" style="border-left: 4px solid var(--danger-color);">
                  <div class="customer-name">${debt.customerName} ${debt.customerSurname}</div>
                  <div class="customer-info">
                      <i class="fas fa-phone"></i>
                      ${debt.customerPhone}
                      <span>${translations[currentLanguage]['Toplam']}: ${debt.totalAmount.toLocaleString('tr-TR')} ${currentCurrencySymbol}</span>
                      <span>${translations[currentLanguage]['Ödenen']}: ${debt.paidAmount.toLocaleString('tr-TR')} ${currentCurrencySymbol}</span>
                      <span style="color: var(--danger-color); font-weight: 600;">${translations[currentLanguage]['Kalan']}: ${debt.remainingAmount.toLocaleString('tr-TR')} ${currentCurrencySymbol}</span>
                  </div>
              </div>
          `).join('');
          
          document.getElementById('paymentsModal').style.display = 'block';
      }

      // Show payment modal
      function showPaymentModal(customerPhone) {
          const debt = debtsData.find(d => d.customerPhone === customerPhone);
          if (!debt) return;

          currentPaymentCustomer = debt;
          
          document.getElementById('paymentCustomerInfo').textContent = `${debt.customerName} ${debt.customerSurname} (${debt.customerPhone})`;
          document.getElementById('paymentTotalDebt').textContent = `${debt.remainingAmount.toLocaleString('tr-TR')} ${currentCurrencySymbol}`;
          document.getElementById('paymentAmount').value = debt.remainingAmount;
          
          // Reset payment type selection
          selectedDebtPaymentType = 'cash';
          document.querySelectorAll('#paymentModal .payment-option').forEach(option => {
              option.classList.remove('selected');
          });
          document.querySelector('#paymentModal .payment-option').classList.add('selected');
          
          document.getElementById('paymentsModal').style.display = 'none';
          document.getElementById('paymentModal').style.display = 'block';
      }

      // Process payment
      async function processPayment() {
          const employeeCode = document.getElementById('paymentEmployeeCode').value;
          const employeeName = verifyEmployeeCode(employeeCode);
          
          if (!employeeName) {
              showAlert(translations[currentLanguage]['Geçersiz çalışan kodu!'], 'error');
              return;
          }

          const paymentAmount = parseFloat(document.getElementById('paymentAmount').value);
          
          if (paymentAmount <= 0 || paymentAmount > currentPaymentCustomer.remainingAmount) {
              showAlert(translations[currentLanguage]['Geçersiz ödeme tutarı!'], 'error');
              return;
          }

          // Update debt
          const debtIndex = debtsData.findIndex(d => d.id === currentPaymentCustomer.id);
          if (debtIndex !== -1) {
              debtsData[debtIndex].paidAmount += paymentAmount;
              debtsData[debtIndex].remainingAmount -= paymentAmount;
              
              // If fully paid, remove from debts
              if (debtsData[debtIndex].remainingAmount <= 0) {
                  debtsData.splice(debtIndex, 1);
              }
          }

          // Add payment record
          const paymentRecord = {
              id: Date.now(),
              date: new Date().toISOString(),
              customerName: currentPaymentCustomer.customerName,
              customerSurname: currentPaymentCustomer.customerSurname,
              customerPhone: currentPaymentCustomer.customerPhone,
              amount: paymentAmount,
              paymentType: selectedDebtPaymentType,
              type: 'debt_payment',
              employee: employeeName,
              debtId: currentPaymentCustomer.id
          };

          paymentsData.push(paymentRecord);
          
          await autoSave();
          showAlert(translations[currentLanguage]['Ödeme başarıyla alındı!'], 'success');
          closePaymentModal();
          updateDashboard();
          updateDebtBadge();
      }

      // Edit functions
      function editSale(saleId) {
          const sale = salesData.find(s => s.id === saleId);
          if (!sale) return;

          currentEditSaleId = saleId;
          document.getElementById('editCustomerName').value = sale.customerName;
          document.getElementById('editCustomerSurname').value = sale.customerSurname;
          document.getElementById('editCustomerPhone').value = sale.customerPhone;
          document.getElementById('editCarpetArea').value = sale.carpetArea;
          document.getElementById('editSalePrice').value = sale.salePrice;
          document.getElementById('editPaidAmount').value = sale.paidAmount;
          
          document.getElementById('editSaleModal').style.display = 'block';
      }

      function editExpense(expenseId) {
          const expense = expensesData.find(e => e.id === expenseId);
          if (!expense) return;

          currentEditExpenseId = expenseId;
          document.getElementById('editExpenseDescription').value = expense.description;
          document.getElementById('editExpenseAmount').value = expense.amount;
          document.getElementById('editExpenseCategory').value = expense.category;
          
          document.getElementById('editExpenseModal').style.display = 'block';
      }

      async function deleteSale(saleId) {
          if (confirm(translations[currentLanguage]['Bu satışı silmek istediğinizden emin misiniz?'])) {
              const saleIndex = salesData.findIndex(s => s.id === saleId);
              if (saleIndex !== -1) {
                  const sale = salesData[saleIndex];
                  
                  salesData.splice(saleIndex, 1);
                  
                  const debtIndex = debtsData.findIndex(d => d.saleId === saleId);
                  if (debtIndex !== -1) {
                      debtsData.splice(debtIndex, 1);
                  }
                  
                  updateCustomerAfterSaleDelete(sale);
                  
                  await autoSave();
                  loadAdminData();
                  updateDashboard();
                  updateDebtBadge();
                  showAlert(translations[currentLanguage]['Satış silindi!'], 'success');
              }
          }
      }

      async function deleteExpense(expenseId) {
          if (confirm(translations[currentLanguage]['Bu gideri silmek istediğinizden emin misiniz?'])) {
              const expenseIndex = expensesData.findIndex(e => e.id === expenseId);
              if (expenseIndex !== -1) {
                  expensesData.splice(expenseIndex, 1);
                  
                  await autoSave();
                  loadAdminData();
                  updateDashboard();
                  showAlert(translations[currentLanguage]['Gider silindi!'], 'success');
              }
          }
      }

      function updateCustomerAfterSaleDelete(deletedSale) {
          const customerIndex = customersData.findIndex(c => c.phone === deletedSale.customerPhone);
          if (customerIndex !== -1) {
              const customer = customersData[customerIndex];
              
              const saleIndexInCustomer = customer.sales.findIndex(s => s.id === deletedSale.id);
              if (saleIndexInCustomer !== -1) {
                  customer.sales.splice(saleIndexInCustomer, 1);
                  customer.totalPurchases -= deletedSale.salePrice;
                  
                  if (customer.sales.length === 0) {
                      customersData.splice(customerIndex, 1);
                  } else {
                      customer.lastPurchase = customer.sales[customer.sales.length - 1].date;
                  }
              }
          }
      }

      // Edit form submissions
      document.getElementById('editSaleForm').addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const saleIndex = salesData.findIndex(s => s.id === currentEditSaleId);
          if (saleIndex !== -1) {
              const oldSale = {...salesData[saleIndex]};
              
              const newSalePrice = parseFloat(document.getElementById('editSalePrice').value);
              const newPaidAmount = parseFloat(document.getElementById('editPaidAmount').value);
              
              salesData[saleIndex].customerName = document.getElementById('editCustomerName').value;
              salesData[saleIndex].customerSurname = document.getElementById('editCustomerSurname').value;
              salesData[saleIndex].customerPhone = document.getElementById('editCustomerPhone').value;
              salesData[saleIndex].carpetArea = parseFloat(document.getElementById('editCarpetArea').value);
              salesData[saleIndex].salePrice = newSalePrice;
              salesData[saleIndex].paidAmount = newPaidAmount;
              
              if (newPaidAmount < newSalePrice) {
                  salesData[saleIndex].paymentType = 'debt';
              } else {
                  salesData[saleIndex].paymentType = salesData[saleIndex].paidPaymentType;
              }
              
              // Handle debt logic
              const existingDebtIndex = debtsData.findIndex(d => d.saleId === currentEditSaleId);
              const remainingAmount = newSalePrice - newPaidAmount;
              
              if (remainingAmount > 0) {
                  if (existingDebtIndex !== -1) {
                      debtsData[existingDebtIndex].customerName = salesData[saleIndex].customerName;
                      debtsData[existingDebtIndex].customerSurname = salesData[saleIndex].customerSurname;
                      debtsData[existingDebtIndex].customerPhone = salesData[saleIndex].customerPhone;
                      debtsData[existingDebtIndex].totalAmount = newSalePrice;
                      debtsData[existingDebtIndex].paidAmount = newPaidAmount;
                      debtsData[existingDebtIndex].remainingAmount = remainingAmount;
                  } else {
                      const newDebt = {
                          id: Date.now(),
                          saleId: currentEditSaleId,
                          customerName: salesData[saleIndex].customerName,
                          customerSurname: salesData[saleIndex].customerSurname,
                          customerPhone: salesData[saleIndex].customerPhone,
                          totalAmount: newSalePrice,
                          paidAmount: newPaidAmount,
                          remainingAmount: remainingAmount,
                          date: salesData[saleIndex].date,
                          employee: salesData[saleIndex].employee
                      };
                      debtsData.push(newDebt);
                  }
              } else {
                  if (existingDebtIndex !== -1) {
                      debtsData.splice(existingDebtIndex, 1);
                  }
              }
              
              updateCustomerAfterSaleEdit(oldSale, salesData[saleIndex]);
              
              await autoSave();
              loadAdminData();
              updateDashboard();
              updateDebtBadge();
              closeEditSale();
              showAlert(translations[currentLanguage]['Satış güncellendi!'], 'success');
          }
      });

      document.getElementById('editExpenseForm').addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const expenseIndex = expensesData.findIndex(e => e.id === currentEditExpenseId);
          if (expenseIndex !== -1) {
              expensesData[expenseIndex].description = document.getElementById('editExpenseDescription').value;
              expensesData[expenseIndex].amount = parseFloat(document.getElementById('editExpenseAmount').value);
              expensesData[expenseIndex].category = document.getElementById('editExpenseCategory').value;
              
              await autoSave();
              loadAdminData();
              updateDashboard();
              closeEditExpense();
              showAlert(translations[currentLanguage]['Gider güncellendi!'], 'success');
          }
      });

      function updateCustomerAfterSaleEdit(oldSale, newSale) {
          const customerIndex = customersData.findIndex(c => c.phone === oldSale.customerPhone);
          if (customerIndex !== -1) {
              const customer = customersData[customerIndex];
              
              const saleIndex = customer.sales.findIndex(s => s.id === newSale.id);
              if (saleIndex !== -1) {
                  customer.totalPurchases = customer.totalPurchases - oldSale.salePrice + newSale.salePrice;
                  customer.sales[saleIndex] = {...newSale};
                  
                  if (oldSale.customerPhone !== newSale.customerPhone) {
                      // If phone number changed, remove from old customer and add to new/existing
                      customer.sales.splice(saleIndex, 1);
                      customer.totalPurchases -= newSale.salePrice;
                      
                      if (customer.sales.length === 0) {
                          customersData.splice(customerIndex, 1);
                      }
                      
                      updateCustomer(newSale.customerName, newSale.customerSurname, newSale.customerPhone, newSale);
                  }
              }
          }
      }

      // Generate report
      function generateReport() {
          const reportType = document.getElementById('reportType').value;
          const reportDate = document.getElementById('reportDate').value || new Date().toISOString().split('T')[0];
          
          let filteredSales, filteredExpenses, filteredDebts, filteredPayments;
          const targetDate = new Date(reportDate);

          if (reportType === 'daily') {
              filteredSales = salesData.filter(sale => {
                  const saleDate = new Date(sale.date);
                  return saleDate.toDateString() === targetDate.toDateString();
              });
              filteredExpenses = expensesData.filter(expense => {
                  const expenseDate = new Date(expense.date);
                  return expenseDate.toDateString() === targetDate.toDateString();
              });
              filteredDebts = debtsData.filter(debt => {
                  const debtDate = new Date(debt.date);
                  return debtDate.toDateString() === targetDate.toDateString();
              });
              filteredPayments = paymentsData.filter(payment => {
                  const paymentDate = new Date(payment.date);
                  return paymentDate.toDateString() === targetDate.toDateString();
              });
          } else if (reportType === 'monthly') {
              filteredSales = salesData.filter(sale => {
                  const saleDate = new Date(sale.date);
                  return saleDate.getMonth() === targetDate.getMonth() && 
                         saleDate.getFullYear() === targetDate.getFullYear();
              });
              filteredExpenses = expensesData.filter(expense => {
                  const expenseDate = new Date(expense.date);
                  return expenseDate.getMonth() === targetDate.getMonth() && 
                         expenseDate.getFullYear() === targetDate.getFullYear();
              });
              filteredDebts = debtsData.filter(debt => {
                  const debtDate = new Date(debt.date);
                  return debtDate.getMonth() === targetDate.getMonth() && 
                         debtDate.getFullYear() === targetDate.getFullYear();
              });
              filteredPayments = paymentsData.filter(payment => {
                  const paymentDate = new Date(payment.date);
                  return paymentDate.getMonth() === targetDate.getMonth() && 
                         paymentDate.getFullYear() === targetDate.getFullYear();
              });
          } else {
              filteredSales = salesData.filter(sale => {
                  const saleDate = new Date(sale.date);
                  return saleDate.getFullYear() === targetDate.getFullYear();
              });
              filteredExpenses = expensesData.filter(expense => {
                  const expenseDate = new Date(expense.date);
                  return expenseDate.getFullYear() === targetDate.getFullYear();
              });
              filteredDebts = debtsData.filter(debt => {
                  const debtDate = new Date(debt.date);
                  return debtDate.getFullYear() === targetDate.getFullYear();
              });
              filteredPayments = paymentsData.filter(payment => {
                  const paymentDate = new Date(payment.date);
                  return paymentDate.getFullYear() === targetDate.getFullYear();
              });
          }

          const totalSales = filteredSales.reduce((sum, sale) => sum + sale.paidAmount, 0);
          const totalPayments = filteredPayments.reduce((sum, payment) => sum + payment.amount, 0);
          const totalIncome = totalSales + totalPayments;
          const totalExpenses = filteredExpenses.reduce((sum, expense) => sum + expense.amount, 0);
          const totalDebt = filteredDebts.reduce((sum, debt) => sum + debt.remainingAmount, 0);

          const reportContent = document.getElementById('reportContent');
          reportContent.innerHTML = `
              <div class="card">
                  <div class="card-header">
                      <h3 class="card-title">
                          <i class="fas fa-chart-bar"></i>
                          ${reportType === 'daily' ? translations[currentLanguage]['Günlük Rapor'] : reportType === 'monthly' ? translations[currentLanguage]['Aylık Rapor'] : translations[currentLanguage]['Yıllık Rapor']}
                      </h3>
                  </div>
                  <div class="card-content">
                      <div class="stats-grid" style="margin: 0 0 24px 0;">
                          <div class="stat-card ripple">
                              <div class="stat-header">
                                  <span class="stat-title">${translations[currentLanguage]['Toplam Gelir']}</span>
                                  <i class="fas fa-lira-sign stat-icon"></i>
                              </div>
                              <div class="stat-value">${totalIncome.toLocaleString('tr-TR')} ${currentCurrencySymbol}</div>
                          </div>
                          <div class="stat-card ripple">
                              <div class="stat-header">
                                  <span class="stat-title">${translations[currentLanguage]['Gider']}</span>
                                  <i class="fas fa-receipt stat-icon"></i>
                              </div>
                              <div class="stat-value">${totalExpenses.toLocaleString('tr-TR')} ${currentCurrencySymbol}</div>
                          </div>
                          <div class="stat-card ripple">
                              <div class="stat-header">
                                  <span class="stat-title">${translations[currentLanguage]['Kar']}</span>
                                  <i class="fas fa-chart-line stat-icon"></i>
                              </div>
                              <div class="stat-value">${(totalIncome - totalExpenses).toLocaleString('tr-TR')} ${currentCurrencySymbol}</div>
                          </div>
                          <div class="stat-card ripple">
                              <div class="stat-header">
                                  <span class="stat-title">${translations[currentLanguage]['Borç']}</span>
                                  <i class="fas fa-exclamation-triangle stat-icon"></i>
                              </div>
                              <div class="stat-value">${totalDebt.toLocaleString('tr-TR')} ${currentCurrencySymbol}</div>
                          </div>
                      </div>
                  </div>
              </div>

              <div class="card">
                  <div class="card-header">
                      <h4 class="card-title">${translations[currentLanguage]['İşlem Detayları']}</h4>
                  </div>
                  <div class="card-content" style="padding: 0;">
                      <div class="table-container">
                          <table class="table">
                              <thead>
                                  <tr>
                                      <th>${translations[currentLanguage]['Tarih']}</th>
                                      <th>${translations[currentLanguage]['Tür']}</th>
                                      <th>${translations[currentLanguage]['Açıklama']}</th>
                                      <th>${translations[currentLanguage]['Tutar']}</th>
                                      <th>${translations[currentLanguage]['Ödeme']}</th>
                                      <th>${translations[currentLanguage]['Çalışan']}</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  ${[
                                      ...filteredSales.map(sale => ({
                                          date: sale.date,
                                          type: translations[currentLanguage]['Satış'],
                                          description: `${sale.customerName} ${sale.customerSurname}`,
                                          amount: sale.paidAmount,
                                          payment: getPaymentTypeDisplay(sale.paidPaymentType),
                                          employee: sale.employee
                                      })),
                                      ...filteredPayments.map(payment => ({
                                          date: payment.date,
                                          type: translations[currentLanguage]['Ödeme'],
                                          description: `${payment.customerName} ${payment.customerSurname}`,
                                          amount: payment.amount,
                                          payment: getPaymentTypeDisplay(payment.paymentType),
                                          employee: payment.employee
                                      })),
                                      ...filteredExpenses.map(expense => ({
                                          date: expense.date,
                                          type: translations[currentLanguage]['Gider'],
                                          description: expense.description,
                                          amount: -expense.amount,
                                          payment: '-',
                                          employee: expense.employee
                                      }))
                                  ].sort((a, b) => new Date(b.date) - new Date(a.date)).map(item => `
                                      <tr>
                                          <td>${new Date(item.date).toLocaleDateString('tr-TR')}</td>
                                          <td>${item.type}</td>
                                          <td>${item.description}</td>
                                          <td style="color: ${item.amount >= 0 ? 'var(--success-color)' : 'var(--danger-color)'}">
                                              ${item.amount >= 0 ? '+' : ''}${item.amount.toLocaleString('tr-TR')} ${currentCurrencySymbol}
                                          </td>
                                          <td>${item.payment}</td>
                                          <td>${item.employee}</td>
                                      </tr>
                                  `).join('')}
                              </tbody>
                          </table>
                      </div>
                  </div>
              </div>

              ${filteredDebts.length > 0 ? `
                  <div class="card">
                      <div class="card-header">
                          <h4 class="card-title">${translations[currentLanguage]['Bekleyen Borçlar']}</h4>
                      </div>
                      <div class="card-content" style="padding: 0;">
                          <div class="table-container">
                              <table class="table">
                                  <thead>
                                      <tr>
                                          <th>${translations[currentLanguage]['Müşteri']}</th>
                                          <th>${translations[currentLanguage]['Telefon']}</th>
                                          <th>${translations[currentLanguage]['Toplam']}</th>
                                          <th>${translations[currentLanguage]['Ödenen']}</th>
                                          <th>${translations[currentLanguage]['Kalan']}</th>
                                      </tr>
                                  </thead>
                                  <tbody>
                                      ${filteredDebts.map(debt => `
                                          <tr>
                                              <td>${debt.customerName} ${debt.customerSurname}</td>
                                              <td>${debt.customerPhone}</td>
                                              <td>${debt.totalAmount.toLocaleString('tr-TR')} ${currentCurrencySymbol}</td>
                                              <td>${debt.paidAmount.toLocaleString('tr-TR')} ${currentCurrencySymbol}</td>
                                              <td style="color: var(--danger-color); font-weight: 600;">${debt.remainingAmount.toLocaleString('tr-TR')} ${currentCurrencySymbol}</td>
                                          </tr>
                                      `).join('')}
                                  </tbody>
                              </table>
                          </div>
                      </div>
                  </div>
              ` : ''}
          `;
      }

      // Download report
      function downloadReport() {
          const reportContent = document.getElementById('reportContent');
          if (!reportContent.innerHTML) {
              showAlert(translations[currentLanguage]['Önce rapor oluşturun!'], 'error');
              return;
          }

          const reportType = document.getElementById('reportType').value;
          
          const printWindow = window.open('', '_blank');
          printWindow.document.write(`
              <html>
              <head>
                  <title>THE LENG - ${reportType} ${translations[currentLanguage]['Rapor']}</title>
                  <style>
                      body { font-family: Arial, sans-serif; margin: 20px; color: #000; }
                      table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                      th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                      th { background-color: #f2f2f2; }
                      .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin: 20px 0; }
                      .stat-card { border: 1px solid #ddd; padding: 20px; text-align: center; }
                      .stat-value { font-size: 24px; font-weight: bold; }
                      h1, h3 { color: #333; }
                  </style>
              </head>
              <body>
                  <h1>THE LENG</h1>
                  ${reportContent.innerHTML}
              </body>
              </html>
          `);
          printWindow.document.close();
          printWindow.print();
      }

      // Clear all data
      async function clearAllData() {
          if (confirm(translations[currentLanguage]['Tüm verileri silmek istediğinizden emin misiniz? Bu işlem geri alınamaz!'])) {
              salesData = [];
              expensesData = [];
              customersData = [];
              debtsData = [];
              paymentsData = [];
              
              await autoSave();
              updateDashboard();
              updateDebtBadge();
              if (isAdminLoggedIn) loadAdminData();
              showAlert(translations[currentLanguage]['Tüm veriler temizlendi!'], 'success');
          }
      }

      // Modal functions
      function closeEditSale() {
          document.getElementById('editSaleModal').style.display = 'none';
          currentEditSaleId = null;
      }

      function closeEditExpense() {
          document.getElementById('editExpenseModal').style.display = 'none';
          currentEditExpenseId = null;
      }

      function closeCustomerModal() {
          document.getElementById('customerModal').style.display = 'none';
      }

      function closePaymentsModal() {
          document.getElementById('paymentsModal').style.display = 'none';
      }

      function closePaymentModal() {
          document.getElementById('paymentModal').style.display = 'none';
          document.getElementById('paymentEmployeeCode').value = '';
          currentPaymentCustomer = null;
      }

      // Show alert
      function showAlert(message, type) {
          const alertDiv = document.createElement('div');
          alertDiv.className = `alert alert-${type}`;
          alertDiv.innerHTML = `
              <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
              ${message}
          `;
          
          document.body.appendChild(alertDiv);
          alertDiv.style.position = 'fixed';
          alertDiv.style.top = '80px';
          alertDiv.style.left = '50%';
          alertDiv.style.transform = 'translateX(-50%)';
          alertDiv.style.zIndex = '9999';
          alertDiv.style.maxWidth = '90%';
          
          setTimeout(() => {
              alertDiv.remove();
          }, 4000);
      }

      // Handle window resize
      window.addEventListener('resize', () => {
          if (window.innerWidth >= 1024) {
              sidebar.classList.remove('open');
              overlay.classList.remove('show');
          }
      });

      // Initialize
      document.addEventListener('DOMContentLoaded', function() {
          initApp();
          setupCustomerAutocomplete();
          // Set initial language texts
          setLanguage(currentLanguage);
      });

      // Close modals when clicking outside
      window.onclick = function(event) {
          const modals = document.querySelectorAll('.modal');
          modals.forEach(modal => {
              if (event.target === modal) {
                  modal.style.display = 'none';
              }
          });
      }
  </script>
</body>
</html>
